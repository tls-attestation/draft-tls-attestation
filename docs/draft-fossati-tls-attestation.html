<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Using Attestation in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</title>
<meta content="Hannes Tschofenig" name="author">
<meta content="Yaron Sheffer" name="author">
<meta content="Paul Howard" name="author">
<meta content="Ionut Mihalcea" name="author">
<meta content="Yogesh Deshpande" name="author">
<meta content="Arto Niemi" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="
       The TLS handshake protocol allows authentication of one or both peers using static, long-term credentials.
In some cases, it is also desirable to ensure that the peer runtime environment is in a secure state.
Such an assurance can be achieved using attestation which is a process by which an entity produces evidence about itself that another party can use to appraise whether that entity is found in a secure state.
This document describes a series of protocol extensions to the TLS 1.3 handshake that enables the binding of the TLS authentication key to a remote attestation session.
This enables an entity capable of producing attestation evidence, such as a confidential workload running in a Trusted Execution Environment (TEE), or an IoT device that is trying to authenticate itself to a network access point, to present a more comprehensive set of security metrics to its peer.
These extensions have been designed to allow the peers to use any attestation technology, in any remote attestation topology, and mutually. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="attestation" name="keyword">
<meta content="RATS" name="keyword">
<meta content="TLS" name="keyword">
<meta content="draft-fossati-tls-attestation-07" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.10.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 24.6.1
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 59.6.0
    wcwidth 0.2.13
-->
<link href="draft-fossati-tls-attestation.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Attestation in TLS/DTLS</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tschofenig, et al.</td>
<td class="center">Expires 9 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TLS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-fossati-tls-attestation-07</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-08" class="published">8 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-09">9 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Tschofenig</div>
</div>
<div class="author">
      <div class="author-name">Y. Sheffer</div>
<div class="org">Intuit</div>
</div>
<div class="author">
      <div class="author-name">P. Howard</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">I. Mihalcea</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">Y. Deshpande</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">A. Niemi</div>
<div class="org">Huawei</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Linaro</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Using Attestation in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The TLS handshake protocol allows authentication of one or both peers using static, long-term credentials.
In some cases, it is also desirable to ensure that the peer runtime environment is in a secure state.
Such an assurance can be achieved using attestation which is a process by which an entity produces evidence about itself that another party can use to appraise whether that entity is found in a secure state.
This document describes a series of protocol extensions to the TLS 1.3 handshake that enables the binding of the TLS authentication key to a remote attestation session.
This enables an entity capable of producing attestation evidence, such as a confidential workload running in a Trusted Execution Environment (TEE), or an IoT device that is trying to authenticate itself to a network access point, to present a more comprehensive set of security metrics to its peer.
These extensions have been designed to allow the peers to use any attestation technology, in any remote attestation topology, and mutually.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-fossati-tls-attestation/">https://datatracker.ietf.org/doc/draft-fossati-tls-attestation/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/yaronf/draft-tls-attestation">https://github.com/yaronf/draft-tls-attestation</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-attestation-extensions" class="internal xref">Attestation Extensions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-use-of-remote-attestation-c" class="internal xref">Use of Remote Attestation Credentials in the TLS Handshake</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-handshake-overview" class="internal xref">Handshake Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-tls-client-authenticating-u" class="internal xref">TLS Client Authenticating Using Evidence</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-tls-server-authenticating-u" class="internal xref">TLS Server Authenticating Using Evidence</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-tls-client-authenticating-us" class="internal xref">TLS Client Authenticating Using Attestation Results</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-tls-server-authenticating-us" class="internal xref">TLS Server Authenticating Using Results</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-evidence-extensions-backgro" class="internal xref">Evidence Extensions (Background Check Model)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-attestation-only" class="internal xref">Attestation-only</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-attestation-alongside-x509-" class="internal xref">Attestation Alongside X.509 Certificates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-channel-binding" class="internal xref">Channel binding</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-attestation-results-extensi" class="internal xref">Attestation Results Extensions (Passport Model)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-tls-client-and-server-hands" class="internal xref">TLS Client and Server Handshake Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-background-check-model" class="internal xref">Background Check Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-client-hello" class="internal xref">Client Hello</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-server-hello" class="internal xref">Server Hello</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-passport-model" class="internal xref">Passport Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-client-hello-2" class="internal xref">Client Hello</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-server-hello-2" class="internal xref">Server Hello</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-background-check-model-exam" class="internal xref">Background-Check Model Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-cloud-confidential-computin" class="internal xref">Cloud Confidential Computing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-iot-device-onboarding" class="internal xref">IoT Device Onboarding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-tls-extensions" class="internal xref">TLS Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-tls-alerts" class="internal xref">TLS Alerts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-tls-certificate-types" class="internal xref">TLS Certificate Types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-design-rationale-x509-and-a" class="internal xref">Design Rationale: X.509 and Attestation Usage Variants</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-history" class="internal xref">History</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-draft-fossati-tls-attestati" class="internal xref">draft-fossati-tls-attestation-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-draft-fossati-tls-attestatio" class="internal xref">draft-fossati-tls-attestation-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-draft-fossati-tls-attestation" class="internal xref">draft-fossati-tls-attestation-00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-working-group-information" class="internal xref">Working Group Information</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Attestation <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> is the process by which an entity produces evidence about itself that another party can use to evaluate the trustworthiness of that entity.
This document describes a series of protocol extensions to the TLS 1.3 handshake that enables the binding of the TLS authentication key to a remote attestation session.
As a result, a peer can use "attestation credentials", consisting of compound platform evidence and key attestation, to authenticate itself to its peer during the setup of the TLS channel.
This enables an attester, such as a confidential workload running in a Trusted Execution Environment (TEE) <span>[<a href="#I-D.ietf-teep-architecture" class="cite xref">I-D.ietf-teep-architecture</a>]</span>, or an IoT device that is trying to authenticate itself to a network access point, to present a more comprehensive set of security metrics to its peer.
This, in turn, allows for the implementation of authorization policies at the relying parties that are based on stronger security signals.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Given the variety of deployed and emerging attestation technologies (e.g., <span>[<a href="#TPM1.2" class="cite xref">TPM1.2</a>]</span>, <span>[<a href="#TPM2.0" class="cite xref">TPM2.0</a>]</span>, <span>[<a href="#I-D.ietf-rats-eat" class="cite xref">I-D.ietf-rats-eat</a>]</span>) these extensions have been explicitly designed to be agnostic of the attestation formats.
This is achieved by reusing the generic encapsulation defined in <span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span> for transporting evidence and attestation result payloads in the TLS Certificate message.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The proposed design supports both background-check and passport topologies, as described in Sections <a href="https://rfc-editor.org/rfc/rfc9334#section-5.2" class="relref">5.2</a> and <a href="https://rfc-editor.org/rfc/rfc9334#section-5.1" class="relref">5.1</a> of <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.
This is detailed in <a href="#evidence-extensions" class="auto internal xref">Section 6</a> and <a href="#attestation-results-extensions" class="auto internal xref">Section 7</a>.
This specification provides both one-way (server-only) and mutual (client and server) authentication using attestation credentials, and allows the attestation topologies at each peer to be independent of each other.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document does not specify any attestation technology.
Companion documents are expected to define specific attestation mechanisms.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The reader is assumed to be familiar with the vocabulary and concepts defined in
<span><a href="https://rfc-editor.org/rfc/rfc9334#section-4" class="relref">Section 4</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, and those in <span><a href="https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-03#section-2" class="relref">Section 2</a> of [<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The following terms are used in this document:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-3">
        <dt id="section-2-3.1">TLS Identity Key (TIK):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
          <p id="section-2-3.2.1">A cryptographic key used by one of the peers to authenticate itself during the
TLS handshake.<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">TIK-C, TIK-S:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">
          <p id="section-2-3.4.1">The TIK that identifies the client or the server, respectively.<a href="#section-2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">TIK-C-ID, TIK-S-ID:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">
          <p id="section-2-3.6.1">An identifier for TIK-C or respectively, TIK-S. This may be a fingerprint 
(cryptographic hash) of the public key, but other implementations are possible.<a href="#section-2-3.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-4">"Remote attestation credentials", or "attestation credentials", is used
to refer to both attestation evidence and attestation results, when no
distinction needs to be made between them.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-3-1">The basic functional goal is to link the authenticated key exchange of TLS with an interleaved remote attestation session in such a way that the key used to sign the handshake can be proven to be residing within the boundaries of an attested TEE.
The requirement is that the attester can provide evidence containing the security status of both the signing key and the platform that is hosting it.
The associated security goal is to obtain such binding so that no replay, relay or splicing from an adversary is possible.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Throughout the document, we will assume the conceptual attester model described in <span><a href="https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-03#section-3" class="relref">Section 3</a> of [<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>, where TEE attestation is provided by a Platform Attestation Token (PAT) signed by the attester's "attesting environment".
Among other security metrics, the PAT contains evidence about the integrity of a "Key Attestation Service" executing within the TEE which issues a Key Attestation Token (KAT) for the TLS handshake signing key (TIK) as described in <a href="#handshake-overview" class="auto internal xref">Section 5.1</a>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The protocol's security relies on the verifiable binding between these two logically separate units of evidence.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attestation-extensions">
<section id="section-4">
      <h2 id="name-attestation-extensions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-attestation-extensions" class="section-name selfRef">Attestation Extensions</a>
      </h2>
<p id="section-4-1">As typical with new features in TLS, the client indicates support for the new
extension in the ClientHello message. The newly introduced extensions allow
remote attestation credentials and nonces to be exchanged. The nonces are used
for guaranteeing freshness of the exchanged evidence when the background check
model is in use.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">When either the evidence or the attestation results extension is successfully
negotiated, the content of the corresponding Certificate message contains a
payload that is encoded based on the wrapper defined in <span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span>.
Both JSON and CBOR serializations are allowed in CMW, with the emitter choosing which serialization to use.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">In TLS a client has to demonstrate possession of the private key via the
CertificateVerify message, when client-based authentication is requested. The
attestation payload must contain assertions relating to the client's TLS
Identity Key (TIK-C), which associate the private key with the attestation
information. These assertions may come in the form of a Key Attestation Token
(KAT), or of specific claims in an attestation result document. An example of a
KAT format utilizing the EAT format can be found in <span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The relying party can obtain and appraise the remote attestation results either
directly from the Certificate message (in the passport model), or by relaying
the evidence from the Certificate message to the verifier and receiving the
attestation results. Subsequently, the attested key is used to verify the
CertificateVerify message.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">When using the passport model, the remote attestation results obtained by the
attester from its trusted verifiers can be cached and used for any number of
subsequent TLS handshakes, as long as the freshness policy requirements are
satisfied.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">This protocol supports both monolithic and split implementations. In a monolithic
implementation, the TLS stack is completely embedded within the TEE. In a split
implementation, the TLS stack is located outside the TEE, but any private keys
(and in particular, the TIK) only exist within the TEE. In order to support
both options, only the TIK's identity and its public component are ever
passed between the Client or Server TLS stack and its Attestation Service.<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-remote-attestation-credentials-in-the-tls-handshake">
<section id="section-5">
      <h2 id="name-use-of-remote-attestation-c">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-use-of-remote-attestation-c" class="section-name selfRef">Use of Remote Attestation Credentials in the TLS Handshake</a>
      </h2>
<p id="section-5-1">For both the passport model (described in section 5.1 of <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) and
background check model (described in Section 5.2 of <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) the following
modes of operation are allowed when used with TLS, namely:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">TLS client is the attester,<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">TLS server is the attester, and<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.3">
          <p id="section-5-2.3.1">TLS client and server mutually attest towards each other.<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">We will show the message exchanges of the first two cases in sub-sections below.
Mutual authentication via attestation combines these two (non-interfering)
flows, including cases where one of the peers uses the passport model for its
attestation, and the other uses the background check model.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="handshake-overview">
<section id="section-5.1">
        <h3 id="name-handshake-overview">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-handshake-overview" class="section-name selfRef">Handshake Overview</a>
        </h3>
<p id="section-5.1-1">The handshake defined here is analogous to certificate-based authentication in a regular TLS handshake. Instead of the certificate's private key, we use
the TIK identity key. This key is attested, with attestation being carried
by the Certificate message. Following that, the peer being attested proves possession of the private key using the CertificateVerify message.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Depending on the use case, the protocol supports peer authentication
using attestation only, or using both attestation and a regular public
key certificate.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The current version of the document assumes the KAT/PAT construct of 
<span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>. Not all platforms support this model, and a document
that defines private key attestation for use in TLS Attestation as defined here, must specify:<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-4.1">
            <p id="section-5.1-4.1.1">The format and the lifetime of TIK (e.g. an ephemeral, per session TIK vs.
a long lived one).<a href="#section-5.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.2">
            <p id="section-5.1-4.2.1">How the key is attested using a structure carried by the
Certificate message.<a href="#section-5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.3">
            <p id="section-5.1-4.3.1">How proof of possession is performed.<a href="#section-5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="tls-client-authenticating-using-evidence">
<section id="section-5.2">
        <h3 id="name-tls-client-authenticating-u">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-tls-client-authenticating-u" class="section-name selfRef">TLS Client Authenticating Using Evidence</a>
        </h3>
<p id="section-5.2-1">In this use case, the TLS server (acting as a relying party) challenges the TLS
client (as the attester) to provide evidence. The TLS server needs to provide a
nonce in the EncryptedExtensions message to the TLS client so that the
attestation service can feed the nonce into the generation of the evidence. The
TLS server, when receiving the evidence, will have to contact the verifier
(which is not shown in the diagram).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">An example of this flow can be found in device onboarding where the 
client initiates the communication with cloud infrastructure to 
get credentials, firmware and other configuration data provisioned
to the device. For the server to consider the device genuine it needs
to present evidence.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<span id="name-tls-client-providing-eviden"></span><div id="_figure-background-check-model1">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-5.2-3.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + evidence_proposal
     | + key_share*
     | + signature_algorithms*
     v                         --------&gt;
                                                  ServerHello  ^ Key
                                                 + key_share*  | Exch
                                                               v
                                        {EncryptedExtensions}  ^  Server
                                          + evidence_proposal  |  Params
                                                      (nonce)  |
                                         {CertificateRequest}  v
                                                {Certificate}  ^
                                          {CertificateVerify}  | Auth
                                                   {Finished}  v
                               &lt;--------  [Application Data*]
     ^ {Certificate}
Auth | {CertificateVerify}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-tls-client-providing-eviden" class="selfRef">TLS Client Providing Evidence to TLS Server.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="tls-server-authenticating-using-evidence">
<section id="section-5.3">
        <h3 id="name-tls-server-authenticating-u">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-tls-server-authenticating-u" class="section-name selfRef">TLS Server Authenticating Using Evidence</a>
        </h3>
<p id="section-5.3-1">In this use case the TLS client challenges the TLS server to present evidence. 
The TLS server acts as an attester while the TLS client is the relying party. 
The TLS client, when receiving the evidence, will have to contact the verifier 
(which is not shown in the diagram).<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">An example of this flow can be found in confidential computing where 
a compute workload is only submitted to the server infrastructure 
once the client/user is assured that the confidential computing platform is
genuine.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<span id="name-tls-server-providing-eviden"></span><div id="_figure-background-check-model2">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-5.3-3.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + evidence_request
     |   (nonce)
     | + key_share*
     | + signature_algorithms*
     v                         --------&gt;
                                                  ServerHello  ^ Key
                                                 + key_share*  | Exch
                                                               v
                                        {EncryptedExtensions}  ^  Server
                                          + evidence_request   |  Params
                                                               |
                                         {CertificateRequest}  v
                                                {Certificate}  ^
                                          {CertificateVerify}  | Auth
                                                   {Finished}  v
                               &lt;--------  [Application Data*]
     ^ {Certificate}
Auth | {CertificateVerify}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-tls-server-providing-eviden" class="selfRef">TLS Server Providing Evidence to TLS Client.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="tls-client-authenticating-using-attestation-results">
<section id="section-5.4">
        <h3 id="name-tls-client-authenticating-us">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-tls-client-authenticating-us" class="section-name selfRef">TLS Client Authenticating Using Attestation Results</a>
        </h3>
<p id="section-5.4-1">In this use case the TLS client, as the attester, provides attestation results
to the TLS server. The TLS client is the attester and the the TLS server acts as
a relying party. Prior to delivering its Certificate message, the client must
contact the verifier (not shown in the diagram) to receive the attestation
results that it will use as credentials.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<span id="name-tls-client-providing-result"></span><div id="_figure-passport-model1">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-5.4-2.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + results_proposal
     | + key_share*
     | + signature_algorithms*
     v                         --------&gt;
                                                  ServerHello  ^ Key
                                                 + key_share*  | Exch
                                                               v
                                        {EncryptedExtensions}  ^  Server
                                           + results_proposal  |  Params
                                         {CertificateRequest}  v
                                                {Certificate}  ^
                                          {CertificateVerify}  | Auth
                                                   {Finished}  v
                               &lt;--------  [Application Data*]
     ^ {Certificate}
Auth | {CertificateVerify}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-tls-client-providing-result" class="selfRef">TLS Client Providing Results to TLS Server.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="tls-server-authenticating-using-results">
<section id="section-5.5">
        <h3 id="name-tls-server-authenticating-us">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-tls-server-authenticating-us" class="section-name selfRef">TLS Server Authenticating Using Results</a>
        </h3>
<p id="section-5.5-1">In this use case the TLS client, as the relying party, requests attestation
results from the TLS server. Prior to delivering its Certificate message, the
server must contact the verifier (not shown in the diagram) to receive the
attestation results that it will use as credentials.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<span id="name-tls-server-providing-attest"></span><div id="_figure-passport-model2">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-5.5-2.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + results_request
     | + key_share*
     | + signature_algorithms*
     v                         --------&gt;
                                                  ServerHello  ^ Key
                                                 + key_share*  | Exch
                                                               v
                                        {EncryptedExtensions}  ^  Server
                                           + results_request   |  Params
                                                               |
                                         {CertificateRequest}  v
                                                {Certificate}  ^
                                          {CertificateVerify}  | Auth
                                                   {Finished}  v
                               &lt;--------  [Application Data*]
     ^ {Certificate}
Auth | {CertificateVerify}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-tls-server-providing-attest" class="selfRef">TLS Server Providing Attestation Results to TLS Client.</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="evidence-extensions">
<section id="section-6">
      <h2 id="name-evidence-extensions-backgro">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-evidence-extensions-backgro" class="section-name selfRef">Evidence Extensions (Background Check Model)</a>
      </h2>
<p id="section-6-1">The EvidenceType structure also contains an indicator for the type of credential
expected in the Certificate message. The credential can either contain
attestation evidence alone, or an X.509 certificate alongside attestation
evidence.<a href="#section-6-1" class="pilcrow">¶</a></p>
<span id="name-tls-extension-structure-for"></span><div id="_figure-extension-evidence">
<figure id="figure-5">
        <div class="alignLeft art-text artwork" id="section-6-2.1">
<pre>
    enum { CONTENT_FORMAT(0), MEDIA_TYPE(1) } typeEncoding;
    enum { ATTESTATION(0), CERT_ATTESTATION(1) } credentialKind;

    struct {
        credentialKind credential_kind;
        typeEncoding type_encoding;
        select (EvidenceType.type_encoding) {
            case CONTENT_FORMAT:
                uint16 content_format;
            case MEDIA_TYPE:
                opaque media_type&lt;0..2^16-1&gt;;
        };
    } EvidenceType;

    struct {
        select(Handshake.msg_type) {
            case client_hello:
                EvidenceType supported_evidence_types&lt;1..2^8-1&gt;;
                opaque nonce&lt;8..2^8-1&gt;;
            case server_hello:
                EvidenceType selected_evidence_type;
        }
    } evidenceRequestTypeExtension;

    struct {
        select(Handshake.msg_type) {
            case client_hello:
                EvidenceType supported_evidence_types&lt;1..2^8-1&gt;;
            case server_hello:
                EvidenceType selected_evidence_type;
                opaque nonce&lt;8..2^8-1&gt;;
        }
    } evidenceProposalTypeExtension;
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-tls-extension-structure-for" class="selfRef">TLS Extension Structure for Evidence.</a>
        </figcaption></figure>
</div>
<div id="attest-only">
<section id="section-6.1">
        <h3 id="name-attestation-only">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-attestation-only" class="section-name selfRef">Attestation-only</a>
        </h3>
<p id="section-6.1-1">When the chosen evidence type indicates the sole use of attestation for
authentication, the Certificate payload is used as a container for
attestation evidence, as shown in <a href="#_figure-attest-only" class="auto internal xref">Figure 6</a>, and follows the
model of <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<span id="name-certificate-message-when-us"></span><div id="_figure-attest-only">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-6.1-2.1">
<pre>
    struct {
        select (certificate_type) {
            case RawPublicKey:
                /* From RFC 7250 ASN.1_subjectPublicKeyInfo */
                opaque ASN1_subjectPublicKeyInfo&lt;1..2^24-1&gt;;

              case X509:
                opaque cert_data&lt;1..2^24-1&gt;;

              case attestation:
                  /* payload used to convey evidence */
                  opaque evidence&lt;1..2^24-1&gt;;
          };
          Extension extensions&lt;0..2^16-1&gt;;
      } CertificateEntry;

      struct {
          opaque certificate_request_context&lt;0..2^8-1&gt;;
          CertificateEntry certificate_list&lt;0..2^24-1&gt;;
      } Certificate;
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-certificate-message-when-us" class="selfRef">Certificate Message when using only attestation.</a>
          </figcaption></figure>
</div>
<p id="section-6.1-3">The encoding of the evidence structure is defined in <span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span>.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pkix-attest">
<section id="section-6.2">
        <h3 id="name-attestation-alongside-x509-">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-attestation-alongside-x509-" class="section-name selfRef">Attestation Alongside X.509 Certificates</a>
        </h3>
<p id="section-6.2-1">When the chosen evidence type indicates usage of both attestation and PKIX,
the X.509 certificate will serve as the main payload in the Certificate
message, while the attestation evidence will be carried in the
CertificateEntry extension, as shown in <a href="#_figure-cert-attest" class="auto internal xref">Figure 7</a>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<span id="name-certificate-message-when-usi"></span><div id="_figure-cert-attest">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-6.2-2.1">
<pre>
    struct {
        select (certificate_type) {
            case RawPublicKey:
                /* From RFC 7250 ASN.1_subjectPublicKeyInfo */
                opaque ASN1_subjectPublicKeyInfo&lt;1..2^24-1&gt;;

            case X509:
                /* X.509 certificate conveyed as usual */
                opaque cert_data&lt;1..2^24-1&gt;;
        };

        /* attestation evidence conveyed as an extension, see below */
        Extension extensions&lt;0..2^16-1&gt;;
      } CertificateEntry;

    struct {
        opaque certificate_request_context&lt;0..2^8-1&gt;;
        CertificateEntry certificate_list&lt;0..2^24-1&gt;;
    } Certificate;

    struct {
        ExtensionType extension_type;
        /* payload used to convey evidence */
        opaque extension_data&lt;0..2^16-1&gt;;
    } Extension;

    enum {
        /* other extension types defined in the IANA TLS
           ExtensionType Value registry */

        /* variant used to identify attestation evidence */
        attestation_evidence(60),
        (65535)
    } ExtensionType;
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-certificate-message-when-usi" class="selfRef">Certificate Message when using PKIX and attestation.</a>
          </figcaption></figure>
</div>
<p id="section-6.2-3">The encoding of the evidence structure is defined in <span>[<a href="#I-D.ietf-rats-msg-wrap" class="cite xref">I-D.ietf-rats-msg-wrap</a>]</span>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">In this use-case the nonce negotiated by the two peers is not used directly as
an input to the attestation evidence generation mechanism. Instead, it is used
in the derivation steps for a channel binder.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<div id="channel-binding">
<section id="section-6.2.1">
          <h4 id="name-channel-binding">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-channel-binding" class="section-name selfRef">Channel binding</a>
          </h4>
<p id="section-6.2.1-1">As described in <a href="#usage-variants" class="auto internal xref">Appendix A</a>, this authentication mechanism is meant
primarily for carrying platform attestation evidence to provide more context to
the relying party. This evidence must be cryptographically bound to the TLS
handshake to prevent relay attacks. A channel binder value plays this role,
allowing a TLS handshake and a remote attestation session to be linked together
in a way that is verifiable by the relying party.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">Creation of the channel binder relies on a new TLS exporter, the Handshake
Exporter. The Handshake Exporter, in turn, uses a new secret value
(handshake_exporter_secret) derived as part of the key schedule.
handshake_exporter_secret is derived from Handshake Secret using Derive-Secret,
with "h exp master" as the label and a handshake context stretching from
ClientHello to ServerHello. This derivation step is shown in
<a href="#_figure-handshake-exporter-secret" class="auto internal xref">Figure 8</a>.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<span id="name-derivation-of-the-handshake"></span><div id="_figure-handshake-exporter-secret">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-6.2.1-3.1">
<pre>
                  [...]
                    |
                    v
     (EC)DHE --&gt; HKDF-Extract = Handshake Secret
                    |
                  [...]
                    |
                    +-----&gt; Derive-Secret(., "h exp master",
                    |                     ClientHello...ServerHello)
                    |              = handshake_exporter_secret
                    v
               Derive-Secret(., "derived", "")
                    |
                    v
                  [...]
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-derivation-of-the-handshake" class="selfRef">Derivation of the Handshake Exporter Secret for use in the associated exporter.</a>
            </figcaption></figure>
</div>
<p id="section-6.2.1-4">The Handshake Secret is used to generate the TLS Handshake Exporter value as
defined in <a href="#_figure-handshake-exporter" class="auto internal xref">Figure 9</a>. This exporter becomes available after
the ServerHello message, and must be offered by implementation as a separate API
(i.e., TLS-Handshake-Exporter) to the TLS-Exporter and TLS-Early-Exporter.<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<span id="name-definition-of-the-tls-hands"></span><div id="_figure-handshake-exporter">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-6.2.1-5.1">
<pre>
TLS-Handshake-Exporter(label, context_value, key_length) =
       HKDF-Expand-Label(
              Derive-Secret(handshake_exporter_secret, label, ""),
              "exporter", Hash(context_value), key_length)
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-definition-of-the-tls-hands" class="selfRef">Definition of the TLS Handshake Exporter.</a>
            </figcaption></figure>
</div>
<p id="section-6.2.1-6">Using this new exporter, the channel binder is then defined as a call to
TLS-Handshake-Exporter with "attestation-binder" as the label, and the nonce
negotiated between attester and relying party as context. This is shown in
<a href="#_figure-channel-binder" class="auto internal xref">Figure 10</a>, where nonce-seed is the negotiated nonce.<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
<span id="name-usage-of-tls-handshake-expo"></span><div id="_figure-channel-binder">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-6.2.1-7.1">
<pre>
channel_binder = TLS-Handshake-Exporter("attestation-binder", nonce-seed, nonce-size)
      = HKDF-Expand-Label(Derive-Secret(handshake_exporter_secret, "attestation-binder", ""),
                      "exporter", Hash(nonce-seed), nonce-size)
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-usage-of-tls-handshake-expo" class="selfRef">Usage of TLS Handshake Exporter for channel binding.</a>
            </figcaption></figure>
</div>
<p id="section-6.2.1-8">channel_binder must be computed by both peers: the attester must use it as a
challenge value when generating attestation evidence; the relying party must
verify its correct inclusion in the evidence it received during the handshake.
Both parties must adjust the size of channel_binder to the length advertised by
the attester.<a href="#section-6.2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="attestation-results-extensions">
<section id="section-7">
      <h2 id="name-attestation-results-extensi">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-attestation-results-extensi" class="section-name selfRef">Attestation Results Extensions (Passport Model)</a>
      </h2>
<span id="name-tls-extension-structure-for-"></span><div id="_figure-extension-results">
<figure id="figure-11">
        <div class="alignLeft art-text artwork" id="section-7-1.1">
<pre>
    struct {
        opaque verifier_identity&lt;0..2^16-1&gt;;
    } VerifierIdentityType;

    struct {
        select(Handshake.msg_type) {
            case client_hello:
                VerifierIdentityType trusted_verifiers&lt;1..2^8-1&gt;;

            case server_hello:
                VerifierIdentityType selected_verifier;
        }
    } resultsRequestTypeExtension;

    struct {
        select(Handshake.msg_type) {
            case client_hello:
                VerifierIdentityType trusted_verifiers&lt;1..2^8-1&gt;;

            case server_hello:
                VerifierIdentityType selected_verifier;
        }
    } resultsProposalTypeExtension;
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-tls-extension-structure-for-" class="selfRef">TLS Extension Structure for Attestation Results.</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="behavior">
<section id="section-8">
      <h2 id="name-tls-client-and-server-hands">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-tls-client-and-server-hands" class="section-name selfRef">TLS Client and Server Handshake Behavior</a>
      </h2>
<p id="section-8-1">The high-level message exchange in <a href="#_figure-overview" class="auto internal xref">Figure 12</a> shows the
evidence_proposal, evidence_request, results_proposal, and results_request
extensions added to the ClientHello and the EncryptedExtensions messages.<a href="#section-8-1" class="pilcrow">¶</a></p>
<span id="name-attestation-message-overvie"></span><div id="_figure-overview">
<figure id="figure-12">
        <div class="alignLeft art-text artwork" id="section-8-2.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + key_share*
     | + signature_algorithms*
     | + psk_key_exchange_modes*
     | + pre_shared_key*
     | + evidence_proposal*
     | + evidence_request*
     | + results_proposal*
     v + results_request*
     --------&gt;
                                                  ServerHello  ^ Key
                                                 + key_share*  | Exch
                                            + pre_shared_key*  v
                                        {EncryptedExtensions}  ^  Server
                                         + evidence_proposal*  |
                                          + evidence_request*  |
                                          + results_proposal*  |
                                           + results_request*  |
                                        {CertificateRequest*}  v  Params
                                               {Certificate*}  ^
                                         {CertificateVerify*}  | Auth
                                                   {Finished}  v
                               &lt;--------  [Application Data*]
     ^ {Certificate*}
Auth | {CertificateVerify*}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-attestation-message-overvie" class="selfRef">Attestation Message Overview.</a>
        </figcaption></figure>
</div>
<div id="background-check-model">
<section id="section-8.1">
        <h3 id="name-background-check-model">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-background-check-model" class="section-name selfRef">Background Check Model</a>
        </h3>
<div id="client-hello">
<section id="section-8.1.1">
          <h4 id="name-client-hello">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-client-hello" class="section-name selfRef">Client Hello</a>
          </h4>
<p id="section-8.1.1-1">To indicate the support for passing evidence in TLS following the 
background check model, clients include the evidence_proposal 
and/or the evidence_request extensions in the ClientHello.<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1.1-2">The evidence_proposal extension in the ClientHello message indicates
the evidence types the client is able to provide to the server,
when requested using a CertificateRequest message.<a href="#section-8.1.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1.1-3">The evidence_request extension in the ClientHello message indicates
the evidence types the client challenges the server to 
provide in a subsequent Certificate payload.<a href="#section-8.1.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1.1-4">The evidence_proposal and evidence_request extensions sent in
the ClientHello each carry a list of supported evidence types,
sorted by preference.  When the client supports only one evidence
type, it is a list containing a single element.<a href="#section-8.1.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1.1-5">The client <span class="bcp14">MUST</span> omit evidence types from the evidence_proposal 
extension in the ClientHello if it cannot respond to a request
from the server to present a proposed evidence type, or if 
the client is not configured to use the proposed evidence type 
with the given server.  If the client has no evidence types 
to send in the ClientHello it <span class="bcp14">MUST</span> omit the evidence_proposal
extension in the ClientHello.<a href="#section-8.1.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1.1-6">The client <span class="bcp14">MUST</span> omit evidence types from the evidence_request
extension in the ClientHello if it is not able to pass the 
indicated verification type to a verifier.  If the client does 
not act as a relying party with regards to evidence processing
(as defined in the RATS architecture) then the client <span class="bcp14">MUST</span> 
omit the evidence_request extension from the ClientHello.<a href="#section-8.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-hello">
<section id="section-8.1.2">
          <h4 id="name-server-hello">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-server-hello" class="section-name selfRef">Server Hello</a>
          </h4>
<p id="section-8.1.2-1">If the server receives a ClientHello that contains the
evidence_proposal extension and/or the evidence_request
extension, then three outcomes are possible:<a href="#section-8.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-2.1">
              <p id="section-8.1.2-2.1.1">The server does not support the extensions defined in this
document.  In this case, the server returns the EncryptedExtensions
without the extensions defined in this document.<a href="#section-8.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.2-2.2">
              <p id="section-8.1.2-2.2.1">The server supports the extensions defined in this document, but
it does not have any evidence type in common with the client.
Then, the server terminates the session with a fatal alert of
type "unsupported_evidence".<a href="#section-8.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.2-2.3">
              <p id="section-8.1.2-2.3.1">The server supports the extensions defined in this document and
has at least one evidence type in common with the client.  In
this case, the processing rules described below are followed.<a href="#section-8.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.1.2-3">The evidence_proposal extension in the ClientHello indicates
the evidence types the client is able to provide to the server,
when challenged using a certificate_request message.  If the
server wants to request evidence from the client, it <span class="bcp14">MUST</span> include the
evidence_proposal extension in the EncryptedExtensions. This
evidence_proposal extension in the EncryptedExtensions then indicates
what evidence format the client is requested to provide in a
subsequent Certificate message.  The value conveyed in the
evidence_proposal extension by the server <span class="bcp14">MUST</span> be selected from one of the
values provided in the evidence_proposal extension sent in the
ClientHello.  The server <span class="bcp14">MUST</span> also send a certificate_request
message.<a href="#section-8.1.2-3" class="pilcrow">¶</a></p>
<p id="section-8.1.2-4">If the server does not send a certificate_request message or none 
of the evidence types supported by the client (as indicated in the
evidence_proposal extension in the ClientHello) match the
server-supported evidence types, then the evidence_proposal
extension in the ServerHello <span class="bcp14">MUST</span> be omitted.<a href="#section-8.1.2-4" class="pilcrow">¶</a></p>
<p id="section-8.1.2-5">The evidence_request extension in the ClientHello indicates what
types of evidence the client can challenge the server to return
in a subsequent Certificate message. With the evidence_request 
extension in the EncryptedExtensions, the server indicates the 
evidence type carried in the Certificate message sent by the server.
The evidence type in the evidence_request extension <span class="bcp14">MUST</span> contain 
a single value selected from the evidence_request extension in 
the ClientHello.<a href="#section-8.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="passport-model">
<section id="section-8.2">
        <h3 id="name-passport-model">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-passport-model" class="section-name selfRef">Passport Model</a>
        </h3>
<div id="client-hello-1">
<section id="section-8.2.1">
          <h4 id="name-client-hello-2">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-client-hello-2" class="section-name selfRef">Client Hello</a>
          </h4>
<p id="section-8.2.1-1">To indicate the support for passing attestation results in TLS following the
passport model, clients include the results_proposal and/or the results_request
extensions in the ClientHello message.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">The results_proposal extension in the ClientHello message indicates the verifier
identities from which it can relay attestation results, when requested using a
CertificateRequest message.<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-8.2.1-3">The results_request extension in the ClientHello message indicates the verifier
identities from which the client expects the server to provide attestation
results in a subsequent Certificate payload.<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
<p id="section-8.2.1-4">The results_proposal and results_request extensions sent in the ClientHello each
carry a list of supported verifier identities, sorted by preference.  When the
client supports only one verifier, it is a list containing a single element.<a href="#section-8.2.1-4" class="pilcrow">¶</a></p>
<p id="section-8.2.1-5">The client <span class="bcp14">MUST</span> omit verifier identities from the results_proposal extension in
the ClientHello if it cannot respond to a request from the server to present
attestation results from a proposed verifier, or if the client is not configured
to relay the results from the proposed verifier with the given server. If the
client has no verifier identities to send in the ClientHello it <span class="bcp14">MUST</span> omit the
results_proposal extension in the ClientHello.<a href="#section-8.2.1-5" class="pilcrow">¶</a></p>
<p id="section-8.2.1-6">The client <span class="bcp14">MUST</span> omit verifier identities from the results_request extension in
the ClientHello if it is not configured to trust attestation results issued by
said verifiers. If the client does not act as a relying party with regards to
the processing of attestation results (as defined in the RATS architecture) then
the client <span class="bcp14">MUST</span> omit the results_request extension from the ClientHello.<a href="#section-8.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-hello-1">
<section id="section-8.2.2">
          <h4 id="name-server-hello-2">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-server-hello-2" class="section-name selfRef">Server Hello</a>
          </h4>
<p id="section-8.2.2-1">If the server receives a ClientHello that contains the results_proposal
extension and/or the results_request extension, then three outcomes are
possible:<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.2-2.1">
              <p id="section-8.2.2-2.1.1">The server does not support the extensions defined in this document.  In this
case, the server returns the EncryptedExtensions without the extensions
defined in this document.<a href="#section-8.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-2.2">
              <p id="section-8.2.2-2.2.1">The server supports the extensions defined in this document, but it does not
have any trusted verifiers in common with the client. Then, the server
terminates the session with a fatal alert of type "unsupported_verifiers".<a href="#section-8.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-2.3">
              <p id="section-8.2.2-2.3.1">The server supports the extensions defined in this document and has at least
one trusted verifier in common with the client.  In this case, the processing
rules described below are followed.<a href="#section-8.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.2.2-3">The results_proposal extension in the ClientHello indicates the verifier
identities from which the client is able to provide attestation results to the
server, when challenged using a certificate_request message.  If the server
wants to request evidence from the client, it <span class="bcp14">MUST</span> include the results_proposal
extension in the EncryptedExtensions. This results_proposal extension in the
EncryptedExtensions then indicates what verifier the client is requested to
provide attestation results from in a subsequent Certificate message.  The value
conveyed in the results_proposal extension by the server <span class="bcp14">MUST</span> be selected from
one of the values provided in the results_proposal extension sent in the
ClientHello.  The server <span class="bcp14">MUST</span> also send a certificate_request message.<a href="#section-8.2.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2.2-4">If the server does not send a certificate_request message or none of the
verifier identities proposed by the client (as indicated in the results_proposal
extension in the ClientHello) match the server-trusted verifiers, then the
results_proposal extension in the ServerHello <span class="bcp14">MUST</span> be omitted.<a href="#section-8.2.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2.2-5">The results_request extension in the ClientHello indicates what verifiers the
client trusts as issuers of attestation results for the server. With the
results_request extension in the EncryptedExtensions, the server indicates the
identity of the verifier who issued the attestation results carried in the
Certificate message sent by the server. The verifier identity in the
results_request extension <span class="bcp14">MUST</span> contain a single value selected from the
results_request extension in the ClientHello.<a href="#section-8.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="background-check-model-examples">
<section id="section-9">
      <h2 id="name-background-check-model-exam">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-background-check-model-exam" class="section-name selfRef">Background-Check Model Examples</a>
      </h2>
<div id="cloud-confidential-computing">
<section id="section-9.1">
        <h3 id="name-cloud-confidential-computin">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-cloud-confidential-computin" class="section-name selfRef">Cloud Confidential Computing</a>
        </h3>
<p id="section-9.1-1">In this example, a confidential workload is executed on computational
resources hosted at a cloud service provider.  This is a typical
scenario for secure, privacy-preserving multiparty computation,
including anti-money laundering, drug development in healthcare, contact
tracing in pandemic times, Machine Learning (ML) model training, etc.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">In such scenarios, the users (e.g., the party providing the data input for the
computation, the party consuming the computed results, or the party
providing a proprietary ML model used in the computation) have two goals:<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-3.1">
            <p id="section-9.1-3.1.1">Identifying the workload they are interacting with,<a href="#section-9.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-3.2">
            <p id="section-9.1-3.2.1">Making sure that the platform on which the workload executes is a
Trusted Execution Environment (TEE) with the expected features.<a href="#section-9.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.1-4">A convenient arrangement is to verify that the two requirements are met
at the same time that the secure channel is established.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">The protocol flow, alongside all the involved actors, is captured in
<a href="#_figure-cc-example" class="auto internal xref">Figure 13</a> where the TLS client is the user (the relying
party) while the TLS server is co-located with the TEE-hosted
confidential workload (the attester).<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1-6">The flow starts with the client initiating a verification session with a
trusted verifier.  The verifier returns the evidence types it
understands and a nonce that will be used to challenge the attester.<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<p id="section-9.1-7">The client starts the TLS handshake with the server by supplying the
attestation-related parameters it has obtained from the verifier.  If
the server supports one of the offered evidence types, it will echo it
in the specular extension and proceed by invoking a local API
(represented by <code>attest_key(...)</code> in the figure below) to request
attestation using the nonce supplied by the verifier.  The returned
evidence binds the identity key (TIK-S) with the platform identity and
security state, packaged into a CAB.  The server then signs a transcript
hash (represented by <code>hs</code> in the figure below) of the handshake context
and the server's Certificate message with the (attested) identity key,
and sends the attestation evidence together with the signature over to
the client.<a href="#section-9.1-7" class="pilcrow">¶</a></p>
<p id="section-9.1-8">The client forwards the attestation evidence to the verifier using the
previously established session, obtains the attestation result (AR) and
checks whether it is acceptable according to its local policy.  If so,
it proceeds and verifies the handshake signature using the corresponding
public key (for example, using the PoP key in the KAT evidence
<span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>).<a href="#section-9.1-8" class="pilcrow">¶</a></p>
<p id="section-9.1-9">The attestation evidence verification combined with the verification of
the CertificateVerify signature provide confirmation that the presented
cryptographic identity is bound to the workload and platform identity,
and that the workload and platform are trustworthy.  Therefore, after
the handshake is finalized, the client can trust the workload on the
other side of the established secure channel to provide the required
confidential computing properties.<a href="#section-9.1-9" class="pilcrow">¶</a></p>
<span id="name-example-exchange-with-serve"></span><div id="_figure-cc-example">
<figure id="figure-13">
          <div id="section-9.1-10.1">
            <div class="alignLeft art-svg artwork" id="section-9.1-10.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1168" width="576" viewBox="0 0 576 1168" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 8,272 L 8,1088" fill="none" stroke="black"></path>
                <path d="M 32,80 L 32,272" fill="none" stroke="black"></path>
                <path d="M 32,304 L 32,1104" fill="none" stroke="black"></path>
                <path d="M 96,48 L 96,80" fill="none" stroke="black"></path>
                <path d="M 136,288 L 136,304" fill="none" stroke="black"></path>
                <path d="M 168,48 L 168,80" fill="none" stroke="black"></path>
                <path d="M 200,80 L 200,1152" fill="none" stroke="black"></path>
                <path d="M 240,48 L 240,80" fill="none" stroke="black"></path>
                <path d="M 280,368 L 280,376" fill="none" stroke="black"></path>
                <path d="M 368,32 L 368,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 400,1152" fill="none" stroke="black"></path>
                <path d="M 448,40 L 448,72" fill="none" stroke="black"></path>
                <path d="M 528,80 L 528,672" fill="none" stroke="black"></path>
                <path d="M 528,704 L 528,1104" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 568,320 L 568,1088" fill="none" stroke="black"></path>
                <path d="M 368,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 96,48" fill="none" stroke="black"></path>
                <path d="M 168,48 L 240,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 96,80" fill="none" stroke="black"></path>
                <path d="M 168,80 L 240,80" fill="none" stroke="black"></path>
                <path d="M 368,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 40,128 L 200,128" fill="none" stroke="black"></path>
                <path d="M 32,240 L 192,240" fill="none" stroke="black"></path>
                <path d="M 8,272 L 120,272" fill="none" stroke="black"></path>
                <path d="M 8,304 L 552,304" fill="none" stroke="black"></path>
                <path d="M 200,416 L 392,416" fill="none" stroke="black"></path>
                <path d="M 400,496 L 520,496" fill="none" stroke="black"></path>
                <path d="M 408,528 L 528,528" fill="none" stroke="black"></path>
                <path d="M 208,672 L 400,672" fill="none" stroke="black"></path>
                <path d="M 400,704 L 520,704" fill="none" stroke="black"></path>
                <path d="M 408,736 L 528,736" fill="none" stroke="black"></path>
                <path d="M 208,784 L 400,784" fill="none" stroke="black"></path>
                <path d="M 40,880 L 200,880" fill="none" stroke="black"></path>
                <path d="M 32,944 L 192,944" fill="none" stroke="black"></path>
                <path d="M 200,960 L 224,960" fill="none" stroke="black"></path>
                <path d="M 208,992 L 224,992" fill="none" stroke="black"></path>
                <path d="M 200,1008 L 224,1008" fill="none" stroke="black"></path>
                <path d="M 208,1040 L 224,1040" fill="none" stroke="black"></path>
                <path d="M 200,1072 L 392,1072" fill="none" stroke="black"></path>
                <path d="M 24,1104 L 552,1104" fill="none" stroke="black"></path>
                <path d="M 208,1136 L 392,1136" fill="none" stroke="black"></path>
                <path d="M 120,272 C 128.83064,272 136,279.16936 136,288" fill="none" stroke="black"></path>
                <path d="M 552,304 C 560.83064,304 568,311.16936 568,320" fill="none" stroke="black"></path>
                <path d="M 224,960 C 232.83064,960 240,967.16936 240,976" fill="none" stroke="black"></path>
                <path d="M 224,992 C 232.83064,992 240,984.83064 240,976" fill="none" stroke="black"></path>
                <path d="M 224,1008 C 232.83064,1008 240,1015.16936 240,1024" fill="none" stroke="black"></path>
                <path d="M 224,1040 C 232.83064,1040 240,1032.83064 240,1024" fill="none" stroke="black"></path>
                <path d="M 24,1104 C 15.16936,1104 8,1096.83064 8,1088" fill="none" stroke="black"></path>
                <path d="M 552,1104 C 560.83064,1104 568,1096.83064 568,1088" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="528,704 516,698.4 516,709.6" fill="black" transform="rotate(0,520,704)"></polygon>
                <polygon class="arrowhead" points="528,496 516,490.4 516,501.6" fill="black" transform="rotate(0,520,496)"></polygon>
                <polygon class="arrowhead" points="416,736 404,730.4 404,741.6" fill="black" transform="rotate(180,408,736)"></polygon>
                <polygon class="arrowhead" points="416,528 404,522.4 404,533.6" fill="black" transform="rotate(180,408,528)"></polygon>
                <polygon class="arrowhead" points="400,1136 388,1130.4 388,1141.6" fill="black" transform="rotate(0,392,1136)"></polygon>
                <polygon class="arrowhead" points="400,1072 388,1066.4 388,1077.6" fill="black" transform="rotate(0,392,1072)"></polygon>
                <polygon class="arrowhead" points="400,416 388,410.4 388,421.6" fill="black" transform="rotate(0,392,416)"></polygon>
                <polygon class="arrowhead" points="216,1136 204,1130.4 204,1141.6" fill="black" transform="rotate(180,208,1136)"></polygon>
                <polygon class="arrowhead" points="216,1040 204,1034.4 204,1045.6" fill="black" transform="rotate(180,208,1040)"></polygon>
                <polygon class="arrowhead" points="216,992 204,986.4 204,997.6" fill="black" transform="rotate(180,208,992)"></polygon>
                <polygon class="arrowhead" points="216,784 204,778.4 204,789.6" fill="black" transform="rotate(180,208,784)"></polygon>
                <polygon class="arrowhead" points="216,672 204,666.4 204,677.6" fill="black" transform="rotate(180,208,672)"></polygon>
                <polygon class="arrowhead" points="200,944 188,938.4 188,949.6" fill="black" transform="rotate(0,192,944)"></polygon>
                <polygon class="arrowhead" points="200,240 188,234.4 188,245.6" fill="black" transform="rotate(0,192,240)"></polygon>
                <polygon class="arrowhead" points="48,880 36,874.4 36,885.6" fill="black" transform="rotate(180,40,880)"></polygon>
                <polygon class="arrowhead" points="48,128 36,122.4 36,133.6" fill="black" transform="rotate(180,40,128)"></polygon>
                <g class="text">
                  <text x="404" y="52">Server</text>
                  <text x="512" y="52">Attestation</text>
                  <text x="52" y="68">Verifier</text>
                  <text x="204" y="68">Client</text>
                  <text x="496" y="68">Service</text>
                  <text x="68" y="116">POST</text>
                  <text x="136" y="116">/newSession</text>
                  <text x="56" y="148">201</text>
                  <text x="104" y="148">Created</text>
                  <text x="80" y="164">Location:</text>
                  <text x="156" y="164">/76839A9</text>
                  <text x="64" y="180">Body:</text>
                  <text x="96" y="180">{</text>
                  <text x="84" y="196">nonce,</text>
                  <text x="124" y="212">supp-media-types</text>
                  <text x="48" y="228">}</text>
                  <text x="32" y="292">TLS</text>
                  <text x="88" y="292">handshake</text>
                  <text x="256" y="324">ClientHello</text>
                  <text x="240" y="340">{...}</text>
                  <text x="288" y="356">evidence_request(</text>
                  <text x="256" y="372">nonce</text>
                  <text x="284" y="388">types(a,b,c)</text>
                  <text x="224" y="404">)</text>
                  <text x="456" y="436">attest_key(</text>
                  <text x="452" y="452">nonce,</text>
                  <text x="460" y="468">TIK-S-ID</text>
                  <text x="416" y="484">)</text>
                  <text x="444" y="516">CAB(KAT,</text>
                  <text x="500" y="516">PAT)</text>
                  <text x="256" y="548">ServerHello</text>
                  <text x="240" y="564">{...}</text>
                  <text x="288" y="580">EncryptedExtensions</text>
                  <text x="240" y="596">{...}</text>
                  <text x="288" y="612">evidence_request(</text>
                  <text x="264" y="628">type(a)</text>
                  <text x="224" y="644">)</text>
                  <text x="292" y="660">Certificate(KAT,PAT)</text>
                  <text x="472" y="692">sign(TIK-S-ID,hs)</text>
                  <text x="456" y="724">sig</text>
                  <text x="300" y="756">CertificateVerify(sig)</text>
                  <text x="244" y="772">Finished</text>
                  <text x="60" y="804">POST</text>
                  <text x="120" y="804">/76839A9E</text>
                  <text x="64" y="820">Body:</text>
                  <text x="96" y="820">{</text>
                  <text x="92" y="836">type(a),</text>
                  <text x="72" y="852">CAB</text>
                  <text x="48" y="868">}</text>
                  <text x="64" y="900">Body:</text>
                  <text x="96" y="900">{</text>
                  <text x="104" y="916">att-result:</text>
                  <text x="172" y="916">AR{}</text>
                  <text x="48" y="932">}</text>
                  <text x="276" y="980">verify</text>
                  <text x="324" y="980">AR{}</text>
                  <text x="276" y="1028">verify</text>
                  <text x="320" y="1028">sig</text>
                  <text x="292" y="1060">Finished</text>
                  <text x="280" y="1124">application</text>
                  <text x="348" y="1124">data</text>
                </g>
              </svg><a href="#section-9.1-10.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-example-exchange-with-serve" class="selfRef">Example Exchange with Server as Attester.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iot-device-onboarding">
<section id="section-9.2">
        <h3 id="name-iot-device-onboarding">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-iot-device-onboarding" class="section-name selfRef">IoT Device Onboarding</a>
        </h3>
<p id="section-9.2-1">In this scenario, an IoT device is connected to a remote device management entity, which could be a cloud service provider or a network operator.
We assume that, initially, the remote device management entity does not trust the device.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">The device management entity's responsibility is to guarantee that the device is running the intended software version, has not been tampered with, and is not being emulated or cloned.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">The protocol flow is shown in <a href="#_figure-iot-example" class="auto internal xref">Figure 14</a> where the client 
is the attester while the server is the relying party.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">The flow starts with the client initiating a TLS exchange with the TLS
server operated by the cloud service provider. The client indicates
what evidence types it supports.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">The server obtains a nonce from the verifier, in real-time or from a
reserved nonce range, and returns it to the client alongside the
selected evidence type. Since the evidence will be returned in the
Certificate message the server has to request mutual authentication
via the CertificateRequest message.<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<p id="section-9.2-6">The client, when receiving the EncryptedExtension with the
evidence_proposal, will proceed by invoking a local API to request the
attestation.  The returned evidence binds the identity key (TIK-C) with
the workload and platform identity and security state, packaged into a
CAB.  The client then signs a transcript hash of the handshake context
and the client's Certificate message  with the (attested) identity key,
and sends the evidence together with the signature over to the server.<a href="#section-9.2-6" class="pilcrow">¶</a></p>
<p id="section-9.2-7">The server forwards the attestation evidence to the verifier, obtains 
the attestation result and checks that it is acceptable according to its 
local policy. The evidence verification combined with the verification of
the CertificateVerify signature provide confirmation that the presented
cryptographic identity is bound to the platform identity, and that the 
platform is trustworthy.<a href="#section-9.2-7" class="pilcrow">¶</a></p>
<p id="section-9.2-8">If successful, the server proceeds with the application layer protocol 
exchange. If, for some reason, the attestation result is not satisfactory
the TLS server will terminate the exchange.<a href="#section-9.2-8" class="pilcrow">¶</a></p>
<span id="name-example-exchange-with-clien"></span><div id="_figure-iot-example">
<figure id="figure-14">
          <div id="section-9.2-9.1">
            <div class="alignLeft art-svg artwork" id="section-9.2-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1152" width="576" viewBox="0 0 576 1152" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 8,112 L 8,1088" fill="none" stroke="black"></path>
                <path d="M 32,80 L 32,112" fill="none" stroke="black"></path>
                <path d="M 32,144 L 32,1088" fill="none" stroke="black"></path>
                <path d="M 136,40 L 136,72" fill="none" stroke="black"></path>
                <path d="M 136,128 L 136,144" fill="none" stroke="black"></path>
                <path d="M 168,80 L 168,664" fill="none" stroke="black"></path>
                <path d="M 168,680 L 168,1136" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 328,48 L 328,80" fill="none" stroke="black"></path>
                <path d="M 368,80 L 368,1136" fill="none" stroke="black"></path>
                <path d="M 400,48 L 400,80" fill="none" stroke="black"></path>
                <path d="M 440,368 L 440,376" fill="none" stroke="black"></path>
                <path d="M 480,48 L 480,80" fill="none" stroke="black"></path>
                <path d="M 528,80 L 528,1088" fill="none" stroke="black"></path>
                <path d="M 568,48 L 568,80" fill="none" stroke="black"></path>
                <path d="M 568,160 L 568,1072" fill="none" stroke="black"></path>
                <path d="M 8,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 328,48 L 400,48" fill="none" stroke="black"></path>
                <path d="M 480,48 L 568,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 328,80 L 400,80" fill="none" stroke="black"></path>
                <path d="M 480,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,112 L 120,112" fill="none" stroke="black"></path>
                <path d="M 8,144 L 552,144" fill="none" stroke="black"></path>
                <path d="M 168,256 L 360,256" fill="none" stroke="black"></path>
                <path d="M 368,304 L 520,304" fill="none" stroke="black"></path>
                <path d="M 376,416 L 528,416" fill="none" stroke="black"></path>
                <path d="M 176,544 L 368,544" fill="none" stroke="black"></path>
                <path d="M 40,592 L 168,592" fill="none" stroke="black"></path>
                <path d="M 32,640 L 160,640" fill="none" stroke="black"></path>
                <path d="M 168,656 L 360,656" fill="none" stroke="black"></path>
                <path d="M 40,688 L 168,688" fill="none" stroke="black"></path>
                <path d="M 32,720 L 160,720" fill="none" stroke="black"></path>
                <path d="M 168,736 L 360,736" fill="none" stroke="black"></path>
                <path d="M 368,848 L 520,848" fill="none" stroke="black"></path>
                <path d="M 376,912 L 528,912" fill="none" stroke="black"></path>
                <path d="M 368,928 L 392,928" fill="none" stroke="black"></path>
                <path d="M 376,960 L 392,960" fill="none" stroke="black"></path>
                <path d="M 368,976 L 392,976" fill="none" stroke="black"></path>
                <path d="M 376,1008 L 392,1008" fill="none" stroke="black"></path>
                <path d="M 8,1088 L 552,1088" fill="none" stroke="black"></path>
                <path d="M 176,1120 L 360,1120" fill="none" stroke="black"></path>
                <path d="M 120,112 C 128.83064,112 136,119.16936 136,128" fill="none" stroke="black"></path>
                <path d="M 552,144 C 560.83064,144 568,151.16936 568,160" fill="none" stroke="black"></path>
                <path d="M 392,928 C 400.83064,928 408,935.16936 408,944" fill="none" stroke="black"></path>
                <path d="M 392,960 C 400.83064,960 408,952.83064 408,944" fill="none" stroke="black"></path>
                <path d="M 392,976 C 400.83064,976 408,983.16936 408,992" fill="none" stroke="black"></path>
                <path d="M 392,1008 C 400.83064,1008 408,1000.83064 408,992" fill="none" stroke="black"></path>
                <path d="M 552,1088 C 560.83064,1088 568,1080.83064 568,1072" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="528,848 516,842.4 516,853.6" fill="black" transform="rotate(0,520,848)"></polygon>
                <polygon class="arrowhead" points="528,304 516,298.4 516,309.6" fill="black" transform="rotate(0,520,304)"></polygon>
                <polygon class="arrowhead" points="384,1008 372,1002.4 372,1013.6" fill="black" transform="rotate(180,376,1008)"></polygon>
                <polygon class="arrowhead" points="384,960 372,954.4 372,965.6" fill="black" transform="rotate(180,376,960)"></polygon>
                <polygon class="arrowhead" points="384,912 372,906.4 372,917.6" fill="black" transform="rotate(180,376,912)"></polygon>
                <polygon class="arrowhead" points="384,416 372,410.4 372,421.6" fill="black" transform="rotate(180,376,416)"></polygon>
                <polygon class="arrowhead" points="368,1120 356,1114.4 356,1125.6" fill="black" transform="rotate(0,360,1120)"></polygon>
                <polygon class="arrowhead" points="368,736 356,730.4 356,741.6" fill="black" transform="rotate(0,360,736)"></polygon>
                <polygon class="arrowhead" points="368,656 356,650.4 356,661.6" fill="black" transform="rotate(0,360,656)"></polygon>
                <polygon class="arrowhead" points="368,256 356,250.4 356,261.6" fill="black" transform="rotate(0,360,256)"></polygon>
                <polygon class="arrowhead" points="184,1120 172,1114.4 172,1125.6" fill="black" transform="rotate(180,176,1120)"></polygon>
                <polygon class="arrowhead" points="184,544 172,538.4 172,549.6" fill="black" transform="rotate(180,176,544)"></polygon>
                <path class="jump" d="M 168,680 C 174,680 174,664 168,664" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="168,720 156,714.4 156,725.6" fill="black" transform="rotate(0,160,720)"></polygon>
                <polygon class="arrowhead" points="168,640 156,634.4 156,645.6" fill="black" transform="rotate(0,160,640)"></polygon>
                <polygon class="arrowhead" points="48,688 36,682.4 36,693.6" fill="black" transform="rotate(180,40,688)"></polygon>
                <polygon class="arrowhead" points="48,592 36,586.4 36,597.6" fill="black" transform="rotate(180,40,592)"></polygon>
                <g class="text">
                  <text x="64" y="52">Attestation</text>
                  <text x="180" y="52">Client</text>
                  <text x="48" y="68">Service</text>
                  <text x="364" y="68">Server</text>
                  <text x="524" y="68">Verifier</text>
                  <text x="32" y="132">TLS</text>
                  <text x="88" y="132">handshake</text>
                  <text x="224" y="180">ClientHello</text>
                  <text x="208" y="196">{...}</text>
                  <text x="260" y="212">evidence_proposal(</text>
                  <text x="252" y="228">types(a,b,c)</text>
                  <text x="192" y="244">)</text>
                  <text x="224" y="292">ServerHello</text>
                  <text x="396" y="292">POST</text>
                  <text x="464" y="292">/newSession</text>
                  <text x="208" y="308">{...}</text>
                  <text x="392" y="324">201</text>
                  <text x="440" y="324">Created</text>
                  <text x="416" y="340">Location:</text>
                  <text x="484" y="340">/76839</text>
                  <text x="400" y="356">Body:</text>
                  <text x="432" y="356">{</text>
                  <text x="416" y="372">nonce</text>
                  <text x="256" y="388">EncryptedExtensions</text>
                  <text x="444" y="388">types(a,b,c)</text>
                  <text x="208" y="404">{...}</text>
                  <text x="384" y="404">}</text>
                  <text x="260" y="420">evidence_proposal(</text>
                  <text x="228" y="436">nonce,</text>
                  <text x="232" y="452">type(a)</text>
                  <text x="192" y="468">)</text>
                  <text x="252" y="484">CertificateRequest</text>
                  <text x="224" y="500">Certificate</text>
                  <text x="248" y="516">CertificateVerify</text>
                  <text x="96" y="532">attest_key(</text>
                  <text x="212" y="532">Finished</text>
                  <text x="92" y="548">nonce,</text>
                  <text x="100" y="564">TIK-C-ID</text>
                  <text x="56" y="580">)</text>
                  <text x="84" y="628">CAB(KAT,</text>
                  <text x="140" y="628">PAT)</text>
                  <text x="260" y="644">Certificate(KAT,PAT)</text>
                  <text x="100" y="676">sign(TIK-C-ID,hs</text>
                  <text x="96" y="708">sig</text>
                  <text x="268" y="708">CertificateVerify(sig)</text>
                  <text x="212" y="724">Finished</text>
                  <text x="396" y="772">POST</text>
                  <text x="456" y="772">/76839A9E</text>
                  <text x="400" y="788">Body:</text>
                  <text x="432" y="788">{</text>
                  <text x="428" y="804">type(a),</text>
                  <text x="408" y="820">CAB</text>
                  <text x="384" y="836">}</text>
                  <text x="400" y="868">Body:</text>
                  <text x="432" y="868">{</text>
                  <text x="432" y="884">att-result:</text>
                  <text x="500" y="884">AR{}</text>
                  <text x="384" y="900">}</text>
                  <text x="444" y="948">verify</text>
                  <text x="492" y="948">AR{}</text>
                  <text x="444" y="996">verify</text>
                  <text x="488" y="996">sig</text>
                  <text x="248" y="1108">application</text>
                  <text x="316" y="1108">data</text>
                </g>
              </svg><a href="#section-9.2-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-example-exchange-with-clien" class="selfRef">Example Exchange with Client as Attester.</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-cons">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">TBD.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="priv-cons">
<section id="section-11">
      <h2 id="name-privacy-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-11-1">In this section, we are assuming that the Attester is a TLS client, representing an individual person.
We are concerned about the potential leakage of privacy sensitive information about that person, such as the correlation of different connections initiated by them.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">In background-check mode, the Verifier not only has access to detailed information about the Attester's TCB through Evidence, but it also knows the exact time and the party with whom the secure channel establishment is attempted (i.e., the RP).
The privacy implications are similar to online OCSP <span>[<a href="#RFC6960" class="cite xref">RFC6960</a>]</span>.
While the RP may trust the Verifier not to disclose any information it receives, the same cannot be assumed for the Attester, which generally has no prior relationship with the Verifier.
Some ways to address this include:<a href="#section-11-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-3.1">
          <p id="section-11-3.1.1">Client-side redaction of privacy-sensitive evidence claims,<a href="#section-11-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-3.2">
          <p id="section-11-3.2.1">Using selective disclosure (e.g., SD-JWT <span>[<a href="#I-D.ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.ietf-oauth-selective-disclosure-jwt</a>]</span> with EAT <span>[<a href="#I-D.ietf-rats-eat" class="cite xref">I-D.ietf-rats-eat</a>]</span>),<a href="#section-11-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-3.3">
          <p id="section-11-3.3.1">Co-locating the Verifier role with the RP,<a href="#section-11-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-3.4">
          <p id="section-11-3.4.1">Utilizing privacy-preserving attestation schemes (e.g., DAA <span>[<a href="#I-D.ietf-rats-daa" class="cite xref">I-D.ietf-rats-daa</a>]</span>), or<a href="#section-11-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-3.5">
          <p id="section-11-3.5.1">Utilizing Attesters manufactured with group identities (e.g., <span>[<a href="#FIDO-REQS" class="cite xref">FIDO-REQS</a>]</span>).<a href="#section-11-3.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-4">The latter two also have the property of hiding the peer's identity from the RP.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">Note that the equivalent of OCSP "stapling" involves using a passport topology where the Verifier's involvement is unrelated to the TLS session.<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">Due to the inherent asymmetry of the TLS protocol, if the Attester acts as the TLS server, a malicious TLS client could potentially retrieve sensitive information from attestation evidence without the client's trustworthiness first being established by the server.<a href="#section-11-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="tls-extensions">
<section id="section-12.1">
        <h3 id="name-tls-extensions">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-tls-extensions" class="section-name selfRef">TLS Extensions</a>
        </h3>
<p id="section-12.1-1">IANA is asked to allocate four new TLS extensions, evidence_request,
evidence_proposal, results_request, results_proposal, from the "TLS
ExtensionType Values" subregistry of the "Transport Layer Security (TLS)
Extensions" registry <span>[<a href="#TLS-Ext-Registry" class="cite xref">TLS-Ext-Registry</a>]</span>.  These extensions are used in the
ClientHello and the EncryptedExtensions messages. The values carried in these
extensions are taken from TBD.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls-alerts">
<section id="section-12.2">
        <h3 id="name-tls-alerts">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-tls-alerts" class="section-name selfRef">TLS Alerts</a>
        </h3>
<p id="section-12.2-1">IANA is requested to allocate a value in the "TLS Alerts"
subregistry of the "Transport Layer Security (TLS) Parameters" registry
<span>[<a href="#TLS-Param-Registry" class="cite xref">TLS-Param-Registry</a>]</span> and populate it with the following entries:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-2.1">
            <p id="section-12.2-2.1.1">Value: TBD1<a href="#section-12.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.2">
            <p id="section-12.2-2.2.1">Description: unsupported_evidence<a href="#section-12.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.3">
            <p id="section-12.2-2.3.1">DTLS-OK: Y<a href="#section-12.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.4">
            <p id="section-12.2-2.4.1">Reference: [This document]<a href="#section-12.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.5">
            <p id="section-12.2-2.5.1">Comment:<a href="#section-12.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.6">
            <p id="section-12.2-2.6.1">Value: TBD2<a href="#section-12.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.7">
            <p id="section-12.2-2.7.1">Description: unsupported_verifiers<a href="#section-12.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.8">
            <p id="section-12.2-2.8.1">DTLS-OK: Y<a href="#section-12.2-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.9">
            <p id="section-12.2-2.9.1">Reference: [This document]<a href="#section-12.2-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.10">
            <p id="section-12.2-2.10.1">Comment:<a href="#section-12.2-2.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="tls-certificate-types">
<section id="section-12.3">
        <h3 id="name-tls-certificate-types">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-tls-certificate-types" class="section-name selfRef">TLS Certificate Types</a>
        </h3>
<p id="section-12.3-1">IANA is requested to allocate a new value in the "TLS Certificate Types"
subregistry of the "Transport Layer Security (TLS) Extensions"
registry <span>[<a href="#TLS-Ext-Registry" class="cite xref">TLS-Ext-Registry</a>]</span>, as follows:<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.3-2.1">
            <p id="section-12.3-2.1.1">Value: TBD2<a href="#section-12.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.2">
            <p id="section-12.3-2.2.1">Description: Attestation<a href="#section-12.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.3">
            <p id="section-12.3-2.3.1">Reference: [This document]<a href="#section-12.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-rats-msg-wrap">[I-D.ietf-rats-msg-wrap]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Smith, N.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"RATS Conceptual Messages Wrapper (CMW)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-msg-wrap-06</span>, <time datetime="2024-07-01" class="refDate">1 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-06">https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DICE-Layering">[DICE-Layering]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"DICE Layering Architecture Version 1.00 Revision 0.19"</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/dice-layering-architecture/">https://trustedcomputinggroup.org/resource/dice-layering-architecture/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIDO-REQS">[FIDO-REQS]</dt>
        <dd>
<span class="refTitle">"FIDO Authenticator Security Requirements"</span>, <time datetime="2021-11" class="refDate">November 2021</time>, <span>&lt;<a href="https://fidoalliance.org/specs/fido-security-requirements/">https://fidoalliance.org/specs/fido-security-requirements/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.acme-device-attest">[I-D.acme-device-attest]</dt>
        <dd>
<span class="refAuthor">Weeks, B.</span>, <span class="refTitle">"Automated Certificate Management Environment (ACME) Device Attestation Extension"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-acme-device-attest-02</span>, <time datetime="2024-02-22" class="refDate">22 February 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-acme-device-attest-02">https://datatracker.ietf.org/doc/html/draft-acme-device-attest-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.bft-rats-kat">[I-D.bft-rats-kat]</dt>
        <dd>
<span class="refAuthor">Brossard, M.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"An EAT-based Key Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bft-rats-kat-03</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-03">https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-selective-disclosure-jwt">[I-D.ietf-oauth-selective-disclosure-jwt]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Yasuda, K.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"Selective Disclosure for JWTs (SD-JWT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-selective-disclosure-jwt-10</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-10">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-ar4si">[I-D.ietf-rats-ar4si]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Hardjono, T.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">V. Scarlata</span>, <span class="refTitle">"Attestation Results for Secure Interactions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-ar4si-06</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-06">https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-daa">[I-D.ietf-rats-daa]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Newton, C.</span>, <span class="refAuthor">Chen, L.</span>, and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Direct Anonymous Attestation for the Remote Attestation Procedures Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-daa-05</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-daa-05">https://datatracker.ietf.org/doc/html/draft-ietf-rats-daa-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-eat">[I-D.ietf-rats-eat]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-29</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-29">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-29</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-architecture">[I-D.ietf-teep-architecture]</dt>
        <dd>
<span class="refAuthor">Pei, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">D. M. Wheeler</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-architecture-19</span>, <time datetime="2022-10-24" class="refDate">24 October 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-teep-architecture-19">https://datatracker.ietf.org/doc/html/draft-ietf-teep-architecture-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RA-TLS">[RA-TLS]</dt>
        <dd>
<span class="refAuthor">Knauth, T.</span>, <span class="refAuthor">Steiner, M.</span>, <span class="refAuthor">Chakrabarti, S.</span>, <span class="refAuthor">Lei, L.</span>, <span class="refAuthor">Xing, C.</span>, and <span class="refAuthor">M. Vij</span>, <span class="refTitle">"Integrating Remote Attestation with Transport Layer Security"</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://arxiv.org/abs/1801.05863">https://arxiv.org/abs/1801.05863</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6960">[RFC6960]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Ankney, R.</span>, <span class="refAuthor">Malpani, A.</span>, <span class="refAuthor">Galperin, S.</span>, and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6960">https://www.rfc-editor.org/rfc/rfc6960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS-Ext-Registry">[TLS-Ext-Registry]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions"</span>, <span>&lt;<a href="https://www.iana.org/assignments/tls-extensiontype-values">https://www.iana.org/assignments/tls-extensiontype-values</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS-Param-Registry">[TLS-Param-Registry]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Transport Layer Security (TLS) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/tls-parameters">https://www.iana.org/assignments/tls-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM1.2">[TPM1.2]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM Main Specification Level 2 Version 1.2, Revision 116"</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-main-specification/">https://trustedcomputinggroup.org/resource/tpm-main-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.0">[TPM2.0]</dt>
      <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library Specification, Family "2.0", Level 00, Revision 01.59"</span>, <time datetime="2019-11" class="refDate">November 2019</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">https://trustedcomputinggroup.org/resource/tpm-library-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="usage-variants">
<section id="appendix-A">
      <h2 id="name-design-rationale-x509-and-a">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-design-rationale-x509-and-a" class="section-name selfRef">Design Rationale: X.509 and Attestation Usage Variants</a>
      </h2>
<p id="appendix-A-1">The inclusion of attestation results and evidence as part of the TLS
handshake offers the relying party information about the state of the
system and its cryptographic keys, but lacks the means to specify a stable
endpoint identifier. While it is possible to solve this problem by
including an identifier as part of the attestation result, some use cases
require the use of a public key infrastructure (PKI). It is therefore
important to consider the possible approaches for conveying X.509
certificates and attestation within a single handshake.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">In general, the following combinations of X.509 and attestation usage are
possible:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A-3">
<li id="appendix-A-3.1">
          <p id="appendix-A-3.1.1">X.509 certificates only: In this case no attestation is exchanged in the
 TLS handshake. Authentication relies on PKI alone, i.e. TLS with X.509
 certificates.<a href="#appendix-A-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-A-3.2">
          <p id="appendix-A-3.2.1">X.509 certificates containing attestation extension: The X.509
 certificates in the Certificate message carry attestation as part of
 the X.509 certificate extensions. Several proposals exist that enable
 this functionality:<a href="#appendix-A-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-3.2.2.1">
              <p id="appendix-A-3.2.2.1.1">Custom X.509 extension:<a href="#appendix-A-3.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-3.2.2.1.2.1">
                  <p id="appendix-A-3.2.2.1.2.1.1">Attester-issued certificates (e.g., RA-TLS <span>[<a href="#RA-TLS" class="cite xref">RA-TLS</a>]</span>): The
attester acts as a certification authority (CA) and includes the
attestation evidence within an X.509 extension.<a href="#appendix-A-3.2.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A-3.2.2.1.2.2">
                  <p id="appendix-A-3.2.2.1.2.2.1">DICE defines extensions that include attestation information in
the "Embedded CA" certificates (See Section 8.1.1.1 of <span>[<a href="#DICE-Layering" class="cite xref">DICE-Layering</a>]</span>).<a href="#appendix-A-3.2.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A-3.2.2.1.2.3">
                  <p id="appendix-A-3.2.2.1.2.3.1">Third party CA-issued certificates (e.g., ACME Device Attestation
<span>[<a href="#I-D.acme-device-attest" class="cite xref">I-D.acme-device-attest</a>]</span>): Remote attestation is performed between
the third party CA and the attester prior to certificate issuance,
after which the CA adds an extension indicating that the certificate
key has fulfilled some verification policy.<a href="#appendix-A-3.2.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-A-3.2.2.2">
              <p id="appendix-A-3.2.2.2.1">Explicit signalling via existing methods, e.g. using a policy OID in
the end-entity certificate.<a href="#appendix-A-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A-3.2.2.3">
              <p id="appendix-A-3.2.2.3.1">Implicit signalling, e.g. via the issuer name.<a href="#appendix-A-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li id="appendix-A-3.3">
          <p id="appendix-A-3.3.1">X.509 certificates alongside a PAT: This use case assumes that a keypair
 with a corresponding certificate already exists and that the owner
 wishes to continue using it. As a consequence, there is no
 cryptographic linkage between the certificate and the PAT. This
 approach is described in <a href="#pkix-attest" class="auto internal xref">Section 6.2</a>.<a href="#appendix-A-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-A-3.4">
          <p id="appendix-A-3.4.1">X.509 certificates alongside the PAT and KAT: The addition of key
 attestation implies that the TLS identity key must have been generated
 and stored securely by the attested platform. Unlike in variant (3),
 the certificate, the KAT, and the PAT must be cryptographically linked.
 This variant is currently not addressed in this document.<a href="#appendix-A-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-A-3.5">
          <p id="appendix-A-3.5.1">Combined PAT/KAT: With this variant the attestation token carries
 information pertaining to both platform and key. No X.509 certificate
 is transmitted during the handshake. This approach is currently not
 addressed in this document.<a href="#appendix-A-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-A-3.6">
          <p id="appendix-A-3.6.1">PAT alongside KAT: This variant is similar to (5) with the exception
 that the key and the platform attestations are stored in separate
 tokens, cryptographically linked together. This approach is covered by
 this document in <a href="#attest-only" class="auto internal xref">Section 6.1</a>. A possible instantiation of the KAT
 is described in <span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>.<a href="#appendix-A-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="history">
<section id="appendix-B">
      <h2 id="name-history">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-history" class="section-name selfRef">History</a>
      </h2>
<p id="appendix-B-1">RFC EDITOR: PLEASE REMOVE THIS SECTION<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="draft-fossati-tls-attestation-02">
<section id="appendix-B.1">
        <h3 id="name-draft-fossati-tls-attestati">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-draft-fossati-tls-attestati" class="section-name selfRef">draft-fossati-tls-attestation-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.1-1.1">
            <p id="appendix-B.1-1.1.1">Focus on the background check model<a href="#appendix-B.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.2">
            <p id="appendix-B.1-1.2.1">Added examples<a href="#appendix-B.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.3">
            <p id="appendix-B.1-1.3.1">Updated introduction<a href="#appendix-B.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.4">
            <p id="appendix-B.1-1.4.1">Moved attestation format-specific content to related drafts.<a href="#appendix-B.1-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-fossati-tls-attestation-01">
<section id="appendix-B.2">
        <h3 id="name-draft-fossati-tls-attestatio">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-draft-fossati-tls-attestatio" class="section-name selfRef">draft-fossati-tls-attestation-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.2-1.1">
            <p id="appendix-B.2-1.1.1">Added details about TPM attestation<a href="#appendix-B.2-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-fossati-tls-attestation-00">
<section id="appendix-B.3">
        <h3 id="name-draft-fossati-tls-attestation">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-draft-fossati-tls-attestation" class="section-name selfRef">draft-fossati-tls-attestation-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.3-1.1">
            <p id="appendix-B.3-1.1.1">Initial version<a href="#appendix-B.3-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="working-group-information">
<section id="appendix-C">
      <h2 id="name-working-group-information">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-working-group-information" class="section-name selfRef">Working Group Information</a>
      </h2>
<p id="appendix-C-1">The discussion list for the IETF TLS working group is located at the e-mail
address <a href="mailto:tls@ietf.org">tls@ietf.org</a>. Information on the group and information on how to
subscribe to the list is at <a href="https://www1.ietf.org/mailman/listinfo/tls">https://www1.ietf.org/mailman/listinfo/tls</a><a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Archives of the list can be found at:
<a href="https://www.ietf.org/mail-archive/web/tls/current/index.html">https://www.ietf.org/mail-archive/web/tls/current/index.html</a><a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaron Sheffer</span></div>
<div dir="auto" class="left"><span class="org">Intuit</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yaronf.ietf@gmail.com" class="email">yaronf.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paul Howard</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Paul.Howard@arm.com" class="email">Paul.Howard@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ionut Mihalcea</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Ionut.Mihalcea@arm.com" class="email">Ionut.Mihalcea@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yogesh Deshpande</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Yogesh.Deshpande@arm.com" class="email">Yogesh.Deshpande@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Arto Niemi</span></div>
<div dir="auto" class="left"><span class="org">Huawei</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:arto.niemi@huawei.com" class="email">arto.niemi@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas.fossati@linaro.org" class="email">thomas.fossati@linaro.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
