<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Using Attestation in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</title>
<meta content="Hannes Tschofenig" name="author">
<meta content="Yaron Sheffer" name="author">
<meta content="Paul Howard" name="author">
<meta content="Ionut Mihalcea" name="author">
<meta content="Yogesh Deshpande" name="author">
<meta content="
       Attestation is the process by which an entity produces evidence about itself
that another party can use to evaluate the trustworthiness of that entity. 
       In use cases that require the use of remote attestation, such as confidential computing
or device onboarding, an attester has to convey evidence or attestation results to 
a relying party. This information exchange may happen at different layers in the 
protocol stack. 
       This specification provides a generic way of passing evidence and attestation results
in the TLS handshake. Functionality-wise this is accomplished with the help of key
attestation. 
    " name="description">
<meta content="xml2rfc 3.16.0" name="generator">
<meta content="attestation" name="keyword">
<meta content="RATS" name="keyword">
<meta content="TLS" name="keyword">
<meta content="draft-fossati-tls-attestation-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.16.0
    Python 3.10.6
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.2
    pycountry 22.3.5
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 59.6.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-fossati-tls-attestation.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Attestation in TLS/DTLS</td>
<td class="right">March 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tschofenig, et al.</td>
<td class="center">Expires 14 September 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TLS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-fossati-tls-attestation-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-03-13" class="published">13 March 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-09-14">14 September 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Tschofenig</div>
</div>
<div class="author">
      <div class="author-name">Y. Sheffer</div>
<div class="org">Intuit</div>
</div>
<div class="author">
      <div class="author-name">P. Howard</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">I. Mihalcea</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">Y. Deshpande</div>
<div class="org">Arm Limited</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Using Attestation in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Attestation is the process by which an entity produces evidence about itself
that another party can use to evaluate the trustworthiness of that entity.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">In use cases that require the use of remote attestation, such as confidential computing
or device onboarding, an attester has to convey evidence or attestation results to 
a relying party. This information exchange may happen at different layers in the 
protocol stack.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This specification provides a generic way of passing evidence and attestation results
in the TLS handshake. Functionality-wise this is accomplished with the help of key
attestation.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-fossati-tls-attestation/">https://datatracker.ietf.org/doc/draft-fossati-tls-attestation/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/yaronf/draft-tls-attestation">https://github.com/yaronf/draft-tls-attestation</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 14 September 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-use-of-evidence-with-the-ba" class="internal xref">Use of Evidence with the Background Check Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-tls-client-as-attester" class="internal xref">TLS Client as Attester</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-tls-server-as-attester" class="internal xref">TLS Server as Attester</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-evidence-extensions-backgro" class="internal xref">Evidence Extensions (Background Check Model)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-attestation-only" class="internal xref">Attestation-only</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-attestation-alongside-x509-" class="internal xref">Attestation alongside X.509 certificates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-tls-client-and-server-hands" class="internal xref">TLS Client and Server Handshake Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-client-hello" class="internal xref">Client Hello</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-server-hello" class="internal xref">Server Hello</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-background-check-model-exam" class="internal xref">Background-Check Model Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-cloud-confidential-computin" class="internal xref">Cloud Confidential Computing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-iot-device-onboarding" class="internal xref">IoT Device Onboarding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-tls-extensions" class="internal xref">TLS Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-tls-alerts" class="internal xref">TLS Alerts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-tls-certificate-types" class="internal xref">TLS Certificate Types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-design-rationale-x509-and-a" class="internal xref">Design Rationale: X.509 and Attestation Usage Variants</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-cross-protocol-binding-mech" class="internal xref">Cross-protocol binding mechanism</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-binding-mechanism" class="internal xref">Binding mechanism</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-usage" class="internal xref">Usage</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-history" class="internal xref">History</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-draft-fossati-tls-attestati" class="internal xref">draft-fossati-tls-attestation-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-draft-fossati-tls-attestatio" class="internal xref">draft-fossati-tls-attestation-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-draft-fossati-tls-attestation" class="internal xref">draft-fossati-tls-attestation-00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-working-group-information" class="internal xref">Working Group Information</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Remote ATtestation ProcedureS (RATS) architecture defines two basic types 
of topological patterns to communicate between an attester, a relying party, and
a verifier, namely the background-check model and the passport model. These two 
models are fundamentally different and require a different treatment when 
incorporated into the TLS handshake. For better readability we suggest to use different 
extensions for these two models.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The two models can be summarized as follows:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">In the background check model, the attester conveys evidence to the relying party,
which then forwards the evidence to the verifier for appraisal; the verifier 
computes the attestation result and sends it back to the relying party.<a href="#section-1-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-3.2">In the passport model, the attester transmits evidence to the verifier 
directly and receives attestation results, which are then relayed to the
relying party.<a href="#section-1-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-4">This specification supports both patterns.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Several formats for encoding evidence are available, such as:
- the Entity Attestation Token (EAT) <span>[<a href="#I-D.ietf-rats-eat" class="cite xref">I-D.ietf-rats-eat</a>]</span>, 
- the Trusted Platform Modules (TPMs) <span>[<a href="#TPM1.2" class="cite xref">TPM1.2</a>]</span> <span>[<a href="#TPM2.0" class="cite xref">TPM2.0</a>]</span>,
- the Android Key Attestation, and
- Apple Key Attestation.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Likewise, there are different encodings available for attestation results.
One such encoding, AR4SI <span>[<a href="#I-D.ietf-rats-ar4si" class="cite xref">I-D.ietf-rats-ar4si</a>]</span> is being standardized by the RATS 
working group.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This version of the specification defines how to support the background check model
in  the TLS handshake, such that the details about the attestation technology are
agnostic to the TLS handshake itself. Later versions of the specification will 
support the passport model as well.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">To give the peer information that the handshake signing key is properly secured, 
the associated evidence has to be verified by that peer.
Hence, attestation evidence about the security state of the signing key is needed, which
is typically associated with evidence about the overall platform state. The platform 
attestation service ensures that the key attestation service has not been tampered with.
The platform attestation service issues the Platform Attestation Token (PAT) and the
key attestation service issues the Key Attestation Token (KAT). The security of the 
protocol critically depends on the verifiable binding between these two logically separate
units of evidence.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">This document does not define how different attestation technologies are encoded.
This is accomplished by companion specifications.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-3-1">The Remote Attestation Procedures (RATS) architecture <span>[<a href="#I-D.ietf-rats-architecture" class="cite xref">I-D.ietf-rats-architecture</a>]</span>
defines two types of interaction models for attestation, namely the passport model
and the background check model. The subsections below explain the difference in their 
interactions.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">As typical with new features in TLS, the client indicates support for the new 
extension in the ClientHello message. The newly introduced extensions allow evidence
and nonces to be exchanged. The nonces are used for guaranteeing freshness of
the exchanged evidence.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">When the evidence extension is successfully negotiated, the content of the
Certificate message contains a payload that is encoded based on the wrapper defined 
in <span>[<a href="#I-D.ftbs-rats-msg-wrap" class="cite xref">I-D.ftbs-rats-msg-wrap</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">In TLS a client has to demonstrate possession of the private key via the CertificateVerify
message, when client-based authentication is requested. The attestation payload
must contain a key attestation token, which associates a private key with the
attestation information. An example of a key attestation token format utilizing 
the EAT format can be found in <span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The recipient extracts evidence from the Certificate message and relays it to the 
verifier to obtain attestation results. Subsequently, the attested key is used
to verify the CertificateVerify message.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-evidence-with-the-background-check-model">
<section id="section-4">
      <h2 id="name-use-of-evidence-with-the-ba">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-use-of-evidence-with-the-ba" class="section-name selfRef">Use of Evidence with the Background Check Model</a>
      </h2>
<p id="section-4-1">The background check model is described in Section 5.2 of 
<span>[<a href="#I-D.ietf-rats-architecture" class="cite xref">I-D.ietf-rats-architecture</a>]</span> and allows the following modes
of operation when used with TLS, namely:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">TLS client is the attester,<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">TLS server is the attester, and<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">TLS client and server mutually attest towards each other.<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">We will show the message exchanges of the three cases in
sub-sections below.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="tls-client-as-attester">
<section id="section-4.1">
        <h3 id="name-tls-client-as-attester">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-tls-client-as-attester" class="section-name selfRef">TLS Client as Attester</a>
        </h3>
<p id="section-4.1-1">In this use case the TLS client, as the attester, is challenged by the TLS
server to provide evidence. The TLS client is the attester and the the TLS
server acts as a relying party. The TLS server needs to provide a nonce
in the EncryptedExtensions message to the TLS client so that the attestation
service can feed the nonce into the generation of the evidence. The TLS 
server, when receiving the evidence, will have to contact the verifier 
(which is not shown in the diagram).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">An example of this flow can be found in device onboarding where the 
client initiates the communication with cloud infrastructure to 
get credentials, firmware and other configuration data provisioned
to the device. For the server to consider the device genuine it needs
to present evidence.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span id="name-tls-client-providing-eviden"></span><div id="_figure-background-check-model1">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.1-3.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + evidence_proposal
     | + key_share*
     | + signature_algorithms*
     v                         --------&gt;
                                                  ServerHello  ^ Key
                                                 + key_share*  | Exch
                                                               v
                                        {EncryptedExtensions}  ^  Server
                                          + evidence_proposal  |  Params
                                                      (nonce)  |
                                         {CertificateRequest}  v
                                                {Certificate}  ^
                                          {CertificateVerify}  | Auth
                                                   {Finished}  v
                               &lt;--------  [Application Data*]
     ^ {Certificate}
Auth | {CertificateVerify}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-tls-client-providing-eviden" class="selfRef">TLS Client Providing Evidence to TLS Server.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="tls-server-as-attester">
<section id="section-4.2">
        <h3 id="name-tls-server-as-attester">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-tls-server-as-attester" class="section-name selfRef">TLS Server as Attester</a>
        </h3>
<p id="section-4.2-1">In this use case the TLS client challenges the TLS server to present evidence. 
The TLS server acts as an attester while the TLS client is the relying party. 
The TLS client, when receiving the evidence, will have to contact the verifier 
(which is not shown in the diagram).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">An example of this flow can be found in confidential computing where 
a compute workload is only submitted to the server infrastructure 
once the client/user is assured that the confidential computing platform is
genuine.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-tls-client-providing-evidenc"></span><div id="_figure-background-check-model2">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-4.2-3.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + evidence_request
     |   (nonce)
     | + key_share*
     | + signature_algorithms*
     v                         --------&gt;
                                                  ServerHello  ^ Key
                                                 + key_share*  | Exch
                                                               v
                                        {EncryptedExtensions}  ^  Server
                                          + evidence_request   |  Params
                                                               |
                                         {CertificateRequest}  v
                                                {Certificate}  ^
                                          {CertificateVerify}  | Auth
                                                   {Finished}  v
                               &lt;--------  [Application Data*]
     ^ {Certificate}
Auth | {CertificateVerify}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-tls-client-providing-evidenc" class="selfRef">TLS Client Providing Evidence to TLS Server.</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="evidence-extensions-background-check-model">
<section id="section-5">
      <h2 id="name-evidence-extensions-backgro">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-evidence-extensions-backgro" class="section-name selfRef">Evidence Extensions (Background Check Model)</a>
      </h2>
<p id="section-5-1">This document defines two new extensions, the evidence_request and 
the evidence_proposal, for use with the background check model.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The EvidenceType structure encodes either a media type or as a
content format. The media type is a string-based identifier 
while the content format uses a number. The former is more 
flexible and does not necessarily require a registration 
through IANA while the latter is more efficient over-the-wire.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The EvidenceType structure also contains an indicator for the type of credential
expected in the Certificate message. The credential can either contain
attestation evidence alone, or an X.509 certificate alongside attestation
evidence.<a href="#section-5-3" class="pilcrow">¶</a></p>
<span id="name-tls-structure-for-evidence"></span><div id="_figure-attestation-type">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-5-4.1">
<pre>
   enum { NUMERIC(0), STRING(1) } encodingType;
   enum { ATTESTATION(0), CERT_ATTESTATION(1) } credentialType;

   struct {
        encodingType type;
        credentialType cred_type;
        select (encodingType) {
            case NUMERIC:
              uint16 content_format;
            case STRING:
               opaque media_type&lt;0..2^16-1&gt;;
        };
   } EvidenceType;

   struct {
           select(ClientOrServerExtension) {
               case client:
                 EvidenceType supported_evidence_types&lt;1..2^8-1&gt;;
                 opaque nonce&lt;0..2^8-1&gt;;

               case server:
                 EvidenceType selected_evidence_type;
           }
   } evidenceRequestTypeExtension;

   struct {
           select(ClientOrServerExtension) {
               case client:
                 EvidenceType supported_evidence_types&lt;1..2^8-1&gt;;

               case server:
                 EvidenceType selected_evidence_type;
                 opaque nonce&lt;0..2^8-1&gt;;
           }
   } evidenceProposalTypeExtension;
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-tls-structure-for-evidence" class="selfRef">TLS Structure for Evidence.</a>
        </figcaption></figure>
</div>
<div id="attest-only">
<section id="section-5.1">
        <h3 id="name-attestation-only">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-attestation-only" class="section-name selfRef">Attestation-only</a>
        </h3>
<p id="section-5.1-1">When the chosen evidence type indicates the sole use of attestation for
authentication, the Certificate payload is used as a container for
attestation evidence, as shown in <a href="#_figure-attest-only" class="auto internal xref">Figure 4</a>, and follows the
model of <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span id="name-certificate-message-when-us"></span><div id="_figure-attest-only">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-5.1-2.1">
<pre>
      struct {
          select (certificate_type) {
              case RawPublicKey:
                /* From RFC 7250 ASN.1_subjectPublicKeyInfo */
                opaque ASN1_subjectPublicKeyInfo&lt;1..2^24-1&gt;;

                /* payload used to convey evidence */
              case attestation:
                opaque evidence&lt;1..2^24-1&gt;;

              case X509:
                opaque cert_data&lt;1..2^24-1&gt;;
          };
          Extension extensions&lt;0..2^16-1&gt;;
      } CertificateEntry;

      struct {
          opaque certificate_request_context&lt;0..2^8-1&gt;;
          CertificateEntry certificate_list&lt;0..2^24-1&gt;;
      } Certificate;
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-certificate-message-when-us" class="selfRef">Certificate Message when using only attestation.</a>
          </figcaption></figure>
</div>
<p id="section-5.1-3">The encoding of the evidence structure is defined in
<span>[<a href="#I-D.ftbs-rats-msg-wrap" class="cite xref">I-D.ftbs-rats-msg-wrap</a>]</span>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pkix-attest">
<section id="section-5.2">
        <h3 id="name-attestation-alongside-x509-">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-attestation-alongside-x509-" class="section-name selfRef">Attestation alongside X.509 certificates</a>
        </h3>
<p id="section-5.2-1">When the chosen evidence type indicates usage of both attestation and PKIX,
the X.509 certificate will serve as the main payload in the Certificate
message, while the attestation evidence will be carried in the
CertificateEntry extension, as shown in <a href="#_figure-cert-attest" class="auto internal xref">Figure 5</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-certificate-message-when-usi"></span><div id="_figure-cert-attest">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-5.2-2.1">
<pre>
      struct {
          select (certificate_type) {
              case RawPublicKey:
                /* From RFC 7250 ASN.1_subjectPublicKeyInfo */
                opaque ASN1_subjectPublicKeyInfo&lt;1..2^24-1&gt;;

              /* X.509 certificate conveyed as usual */
              case X509:
                opaque cert_data&lt;1..2^24-1&gt;;
          };
          /* attestation evidence conveyed as an extension, see below */
          Extension extensions&lt;0..2^16-1&gt;;
      } CertificateEntry;

      struct {
        opaque certificate_request_context&lt;0..2^8-1&gt;;
        CertificateEntry certificate_list&lt;0..2^24-1&gt;;
      } Certificate;

      struct {
        ExtensionType extension_type;
        /* payload used to convey evidence */
        opaque extension_data&lt;0..2^16-1&gt;;
      } Extension;

      enum {
        /* other extension types defined in the IANA TLS
            ExtensionType Value registry */

        /* variant used to identify attestation evidence */
        attestation_evidence(60),
        (65535)
      } ExtensionType;
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-certificate-message-when-usi" class="selfRef">Certificate Message when using PKIX and attestation.</a>
          </figcaption></figure>
</div>
<p id="section-5.2-3">The encoding of the evidence structure is defined in
<span>[<a href="#I-D.ftbs-rats-msg-wrap" class="cite xref">I-D.ftbs-rats-msg-wrap</a>]</span>.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">As described in <a href="#usage-variants" class="auto internal xref">Appendix A</a>, this authentication mechanism is meant
primarily for carrying platform attestation evidence to provide more
context to the relying party. This evidence must be cryptographically bound
to the TLS handshake to prevent relay attacks. An Attestation Channel Binder as
described in <a href="#binding-mech" class="auto internal xref">Appendix B</a> is therefore used when the attestation scheme
does not allow the binding data to be part of the token. The structure of
the binder is given in <a href="#_figure-tls-binder" class="auto internal xref">Figure 6</a>.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<span id="name-format-of-tls-channel-binde"></span><div id="_figure-tls-binder">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-5.2-5.1">
<pre>
attestation_channel_binder = {
  &amp;(nonce: 1) =&gt; bstr .size (8..64)
  &amp;(ik_pub_fingerprint: 2) =&gt; bstr .size (16..64)
  &amp;(channel_binder: 3) =&gt; bstr .size (16..64)
}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-format-of-tls-channel-binde" class="selfRef">Format of TLS channel binder.</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-5.2-6.1">Nonce is the value provided as a challenge by the relying party.<a href="#section-5.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.2">The identity key public fingerprint (ik_pub_fingerprint) is a hash of the
Subject Public Key Info from the leaf X.509 certificate transmitted in
the handshake.<a href="#section-5.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.3">The channel binder (channel_binder) is a partial transcript of the TLS
handshake, up to (but not including) the Certificate message.<a href="#section-5.2-6.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-7">A hash of the binder must be included in the attestation evidence. Previous
to hashing, the binder must be encoded as described in <a href="#binding-mech" class="auto internal xref">Appendix B</a>.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">The hash algorithm negotiatied within the handshake must be used wherever
hashing is required for the binder.<a href="#section-5.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="behavior">
<section id="section-6">
      <h2 id="name-tls-client-and-server-hands">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-tls-client-and-server-hands" class="section-name selfRef">TLS Client and Server Handshake Behavior</a>
      </h2>
<p id="section-6-1">The high-level message exchange in <a href="#_figure-overview" class="auto internal xref">Figure 7</a> shows the
evidence_proposal and evidence_request extensions added
to the ClientHello and the EncryptedExtensions messages.<a href="#section-6-1" class="pilcrow">¶</a></p>
<span id="name-attestation-message-overvie"></span><div id="_figure-overview">
<figure id="figure-7">
        <div class="alignLeft art-text artwork" id="section-6-2.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + key_share*
     | + signature_algorithms*
     | + psk_key_exchange_modes*
     | + pre_shared_key*
     | + evidence_proposal
     v + evidence_request
     --------&gt;
                                                  ServerHello  ^ Key
                                                 + key_share*  | Exch
                                            + pre_shared_key*  v
                                        {EncryptedExtensions}  ^  Server
                                          + evidence_proposal  |
                                           + evidence_request  |
                                        {CertificateRequest*}  v  Params
                                               {Certificate*}  ^
                                         {CertificateVerify*}  | Auth
                                                   {Finished}  v
                               &lt;--------  [Application Data*]
     ^ {Certificate*}
Auth | {CertificateVerify*}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-attestation-message-overvie" class="selfRef">Attestation Message Overview.</a>
        </figcaption></figure>
</div>
<div id="client-hello">
<section id="section-6.1">
        <h3 id="name-client-hello">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-client-hello" class="section-name selfRef">Client Hello</a>
        </h3>
<p id="section-6.1-1">To indicate the support for passing evidence in TLS following the 
background check model, clients include the evidence_proposal 
and/or the evidence_request extensions in the ClientHello.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The evidence_proposal extension in the ClientHello message indicates
the evidence types the client is able to provide to the server,
when requested using a CertificateRequest message.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">The evidence_request extension in the ClientHello message indicates
the evidence types the client challenges the server to 
provide in a subsequent Certificate payload.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">The evidence_proposal and evidence_request extensions sent in
the ClientHello each carry a list of supported evidence types,
sorted by preference.  When the client supports only one evidence
type, it is a list containing a single element.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">The client MUST omit evidence types from the evidence_proposal 
extension in the ClientHello if it cannot respond to a request
from the server to present a proposed evidence type, or if 
the client is not configured to use the proposed evidence type 
with the given server.  If the client has no evidence types 
to send in the ClientHello it MUST omit the evidence_proposal
extension in the ClientHello.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">The client MUST omit evidence types from the evidence_request
extension in the ClientHello if it is not able to pass the 
indicated verification type to a verifier.  If the client does 
not act as a relying party with regards to evidence processing
(as defined in the RATS architecture) then the client MUST 
omit the evidence_request extension from the ClientHello.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-hello">
<section id="section-6.2">
        <h3 id="name-server-hello">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-server-hello" class="section-name selfRef">Server Hello</a>
        </h3>
<p id="section-6.2-1">If the server receives a ClientHello that contains the
evidence_proposal extension and/or the evidence_request
extension, then three outcomes are possible:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">The server does not support the extensions defined in this
document.  In this case, the server returns the EncryptedExtensions
without the extensions defined in this document.<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.2">The server supports the extensions defined in this document, but
it does not have any evidence type in common with the client.
Then, the server terminates the session with a fatal alert of
type "unsupported_evidence".<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.3">The server supports the extensions defined in this document and
has at least one evidence type in common with the client.  In
this case, the processing rules described below are followed.<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-3">The evidence_proposal extension in the ClientHello indicates
the evidence types the client is able to provide to the server,
when challenged using a certificate_request message.  If the
server wants to request evidence from the client, it MUST include the
client_attestation_type extension in the EncryptedExtensions. This
evidence_proposal extension in the EncryptedExtensions then indicates
what evidence format the client is requested to provide in a
subsequent Certificate message.  The value conveyed in the
evidence_proposal extension by the server MUST be selected from one of the
values provided in the evidence_proposal extension sent in the
ClientHello.  The server MUST also send a certificate_request
message.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">If the server does not send a certificate_request message or none 
of the evidence types supported by the client (as indicated in the
evidence_proposal extension in the ClientHello) match the
server-supported evidence types, then the evidence_proposal
extension in the ServerHello MUST be omitted.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">The evidence_request extension in the ClientHello indicates what
types of evidence the client can challenge the server to return
in a subsequent Certificate message. With the evidence_request 
extension in the EncryptedExtensions, the server indicates the 
evidence type carried in the Certificate message sent by the server.
The evidence type in the evidence_request extension MUST contain 
a single value selected from the evidence_request extension in 
the ClientHello.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="background-check-model-examples">
<section id="section-7">
      <h2 id="name-background-check-model-exam">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-background-check-model-exam" class="section-name selfRef">Background-Check Model Examples</a>
      </h2>
<div id="cloud-confidential-computing">
<section id="section-7.1">
        <h3 id="name-cloud-confidential-computin">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-cloud-confidential-computin" class="section-name selfRef">Cloud Confidential Computing</a>
        </h3>
<p id="section-7.1-1">In this example, a confidential workload is executed on computational
resources hosted at a cloud service provider.  This is a typical
scenario for secure, privacy-preserving multiparty computation,
including anti-money laundering, drug development in healthcare, contact
tracing in pandemic times, etc.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">In such scenarios, the users (e.g., the party providing the data input
for the computation, the consumer of the computed results, the party
providing a proprietary ML model used in the computation) have two
goals:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.1">Identifying the workload they are interacting with,<a href="#section-7.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.2">Making sure that the platform on which the workload executes is a
Trusted Execution Environment (TEE) with the expected features.<a href="#section-7.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.1-4">A convenient arrangement is to verify that the two requirements are met
at the same time that the secure channel is established.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">The protocol flow, alongside all the involved actors, is captured in
<a href="#_figure-cc-example" class="auto internal xref">Figure 8</a> where the TLS client is the user (the relying
party) while the TLS server is co-located with the TEE-hosted
confidential workload (the attester).<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">The flow starts with the client initiating a verification session with a
trusted verifier.  The verifier returns the kinds of evidence it
understands and a nonce that will be used to challenge the attester.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7">The client starts the TLS handshake with the server by supplying the
attestation-related parameters it has obtained from the verifier.  If
the server supports one of the offered evidence types, it will echo it
in the specular extension and proceed by invoking the local API to
request the attestation.  The returned evidence binds the identity key
with the platform identity and security state.  The server
then signs the handshake transcript with the (attested) identity key,
and sends the attestation evidence together with the signature over to
the client.<a href="#section-7.1-7" class="pilcrow">¶</a></p>
<p id="section-7.1-8">The client forwards the attestation evidence to the verifier using the
previously established session, obtains the attestation result and
checks whether it is acceptable according to its local policy.  If so, it
proceeds and verifies the handshake signature using the corresponding
public key (for example, using the PoP key in the KAT evidence
<span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>).<a href="#section-7.1-8" class="pilcrow">¶</a></p>
<p id="section-7.1-9">The attestation evidence verification combined with the verification of
the CertificateVerify signature provide confirmation that the presented
cryptographic identity is bound to the workload and platform identity,
and that the workload and platform are trustworthy.  Therefore, after
the handshake is finalized, the client can trust the workload on the
other side of the established secure channel to provide the required
confidential computing properties.<a href="#section-7.1-9" class="pilcrow">¶</a></p>
<span id="name-example-exchange-with-serve"></span><div id="_figure-cc-example">
<figure id="figure-8">
          <div id="section-7.1-10.1">
            <div class="alignLeft art-svg artwork" id="section-7.1-10.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1168" width="576" viewBox="0 0 576 1168" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 8,272 L 8,1088" fill="none" stroke="black"></path>
                <path d="M 32,80 L 32,272" fill="none" stroke="black"></path>
                <path d="M 32,304 L 32,1104" fill="none" stroke="black"></path>
                <path d="M 96,48 L 96,80" fill="none" stroke="black"></path>
                <path d="M 136,288 L 136,304" fill="none" stroke="black"></path>
                <path d="M 168,48 L 168,80" fill="none" stroke="black"></path>
                <path d="M 200,80 L 200,1152" fill="none" stroke="black"></path>
                <path d="M 240,48 L 240,80" fill="none" stroke="black"></path>
                <path d="M 280,368 L 280,376" fill="none" stroke="black"></path>
                <path d="M 368,32 L 368,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 400,1152" fill="none" stroke="black"></path>
                <path d="M 448,40 L 448,72" fill="none" stroke="black"></path>
                <path d="M 528,80 L 528,1104" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 568,320 L 568,1088" fill="none" stroke="black"></path>
                <path d="M 368,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 96,48" fill="none" stroke="black"></path>
                <path d="M 168,48 L 240,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 96,80" fill="none" stroke="black"></path>
                <path d="M 168,80 L 240,80" fill="none" stroke="black"></path>
                <path d="M 368,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 40,128 L 200,128" fill="none" stroke="black"></path>
                <path d="M 32,240 L 192,240" fill="none" stroke="black"></path>
                <path d="M 8,272 L 120,272" fill="none" stroke="black"></path>
                <path d="M 8,304 L 552,304" fill="none" stroke="black"></path>
                <path d="M 200,416 L 392,416" fill="none" stroke="black"></path>
                <path d="M 208,544 L 400,544" fill="none" stroke="black"></path>
                <path d="M 400,624 L 520,624" fill="none" stroke="black"></path>
                <path d="M 408,656 L 528,656" fill="none" stroke="black"></path>
                <path d="M 400,688 L 520,688" fill="none" stroke="black"></path>
                <path d="M 408,720 L 528,720" fill="none" stroke="black"></path>
                <path d="M 208,784 L 400,784" fill="none" stroke="black"></path>
                <path d="M 40,880 L 200,880" fill="none" stroke="black"></path>
                <path d="M 32,944 L 192,944" fill="none" stroke="black"></path>
                <path d="M 200,960 L 224,960" fill="none" stroke="black"></path>
                <path d="M 208,992 L 224,992" fill="none" stroke="black"></path>
                <path d="M 200,1008 L 224,1008" fill="none" stroke="black"></path>
                <path d="M 208,1040 L 224,1040" fill="none" stroke="black"></path>
                <path d="M 200,1072 L 392,1072" fill="none" stroke="black"></path>
                <path d="M 24,1104 L 552,1104" fill="none" stroke="black"></path>
                <path d="M 208,1136 L 392,1136" fill="none" stroke="black"></path>
                <path d="M 120,272 C 128.83064,272 136,279.16936 136,288" fill="none" stroke="black"></path>
                <path d="M 552,304 C 560.83064,304 568,311.16936 568,320" fill="none" stroke="black"></path>
                <path d="M 224,960 C 232.83064,960 240,967.16936 240,976" fill="none" stroke="black"></path>
                <path d="M 224,992 C 232.83064,992 240,984.83064 240,976" fill="none" stroke="black"></path>
                <path d="M 224,1008 C 232.83064,1008 240,1015.16936 240,1024" fill="none" stroke="black"></path>
                <path d="M 224,1040 C 232.83064,1040 240,1032.83064 240,1024" fill="none" stroke="black"></path>
                <path d="M 24,1104 C 15.16936,1104 8,1096.83064 8,1088" fill="none" stroke="black"></path>
                <path d="M 552,1104 C 560.83064,1104 568,1096.83064 568,1088" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="528,688 516,682.4 516,693.6" fill="black" transform="rotate(0,520,688)"></polygon>
                <polygon class="arrowhead" points="528,624 516,618.4 516,629.6" fill="black" transform="rotate(0,520,624)"></polygon>
                <polygon class="arrowhead" points="416,720 404,714.4 404,725.6" fill="black" transform="rotate(180,408,720)"></polygon>
                <polygon class="arrowhead" points="416,656 404,650.4 404,661.6" fill="black" transform="rotate(180,408,656)"></polygon>
                <polygon class="arrowhead" points="400,1136 388,1130.4 388,1141.6" fill="black" transform="rotate(0,392,1136)"></polygon>
                <polygon class="arrowhead" points="400,1072 388,1066.4 388,1077.6" fill="black" transform="rotate(0,392,1072)"></polygon>
                <polygon class="arrowhead" points="400,416 388,410.4 388,421.6" fill="black" transform="rotate(0,392,416)"></polygon>
                <polygon class="arrowhead" points="216,1136 204,1130.4 204,1141.6" fill="black" transform="rotate(180,208,1136)"></polygon>
                <polygon class="arrowhead" points="216,1040 204,1034.4 204,1045.6" fill="black" transform="rotate(180,208,1040)"></polygon>
                <polygon class="arrowhead" points="216,992 204,986.4 204,997.6" fill="black" transform="rotate(180,208,992)"></polygon>
                <polygon class="arrowhead" points="216,784 204,778.4 204,789.6" fill="black" transform="rotate(180,208,784)"></polygon>
                <polygon class="arrowhead" points="216,544 204,538.4 204,549.6" fill="black" transform="rotate(180,208,544)"></polygon>
                <polygon class="arrowhead" points="200,944 188,938.4 188,949.6" fill="black" transform="rotate(0,192,944)"></polygon>
                <polygon class="arrowhead" points="200,240 188,234.4 188,245.6" fill="black" transform="rotate(0,192,240)"></polygon>
                <polygon class="arrowhead" points="48,880 36,874.4 36,885.6" fill="black" transform="rotate(180,40,880)"></polygon>
                <polygon class="arrowhead" points="48,128 36,122.4 36,133.6" fill="black" transform="rotate(180,40,128)"></polygon>
                <g class="text">
                  <text x="404" y="52">Server</text>
                  <text x="512" y="52">Attestation</text>
                  <text x="52" y="68">Verifier</text>
                  <text x="204" y="68">Client</text>
                  <text x="496" y="68">Service</text>
                  <text x="68" y="116">POST</text>
                  <text x="136" y="116">/newSession</text>
                  <text x="56" y="148">201</text>
                  <text x="104" y="148">Created</text>
                  <text x="80" y="164">Location:</text>
                  <text x="156" y="164">/76839A9</text>
                  <text x="64" y="180">Body:</text>
                  <text x="96" y="180">{</text>
                  <text x="84" y="196">nonce,</text>
                  <text x="124" y="212">supp-media-types</text>
                  <text x="48" y="228">}</text>
                  <text x="32" y="292">TLS</text>
                  <text x="88" y="292">handshake</text>
                  <text x="256" y="324">ClientHello</text>
                  <text x="240" y="340">{...}</text>
                  <text x="288" y="356">evidence_request(</text>
                  <text x="256" y="372">nonce</text>
                  <text x="284" y="388">types(a,b,c)</text>
                  <text x="224" y="404">)</text>
                  <text x="256" y="436">ServerHello</text>
                  <text x="240" y="452">{...}</text>
                  <text x="288" y="468">EncryptedExtensions</text>
                  <text x="240" y="484">{...}</text>
                  <text x="288" y="500">evidence_request(</text>
                  <text x="264" y="516">type(a)</text>
                  <text x="224" y="532">)</text>
                  <text x="456" y="564">attest_key(</text>
                  <text x="452" y="580">nonce,</text>
                  <text x="440" y="596">TIK</text>
                  <text x="416" y="612">)</text>
                  <text x="444" y="644">CAB(KAT,</text>
                  <text x="500" y="644">PAT)</text>
                  <text x="460" y="676">sign(TIK,hs)</text>
                  <text x="456" y="708">sig</text>
                  <text x="292" y="740">Certificate(KAT,PAT)</text>
                  <text x="300" y="756">CertificateVerify(sig)</text>
                  <text x="244" y="772">Finished</text>
                  <text x="60" y="804">POST</text>
                  <text x="120" y="804">/76839A9E</text>
                  <text x="64" y="820">Body:</text>
                  <text x="96" y="820">{</text>
                  <text x="92" y="836">type(a),</text>
                  <text x="72" y="852">CAB</text>
                  <text x="48" y="868">}</text>
                  <text x="64" y="900">Body:</text>
                  <text x="96" y="900">{</text>
                  <text x="104" y="916">att-result:</text>
                  <text x="172" y="916">AR{}</text>
                  <text x="48" y="932">}</text>
                  <text x="276" y="980">verify</text>
                  <text x="324" y="980">AR{}</text>
                  <text x="276" y="1028">verify</text>
                  <text x="320" y="1028">sig</text>
                  <text x="292" y="1060">Finished</text>
                  <text x="280" y="1124">application</text>
                  <text x="348" y="1124">data</text>
                </g>
              </svg><a href="#section-7.1-10.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-example-exchange-with-serve" class="selfRef">Example Exchange with Server as Attester.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="iot-device-onboarding">
<section id="section-7.2">
        <h3 id="name-iot-device-onboarding">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-iot-device-onboarding" class="section-name selfRef">IoT Device Onboarding</a>
        </h3>
<p id="section-7.2-1">In this example, an IoT is onboarded to a cloud service provider (or to a
network operator). In this scenario there is typically no a priori
relationship between the device and the cloud service provider that 
will remotely manage the device.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">In such scenario, the cloud service provider wants to make sure
that the device runs the correct version of firmware, has not been 
rooted, is not emulated or cloned.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">The protocol flow is shown in <a href="#_figure-iot-example" class="auto internal xref">Figure 9</a> where the client 
is the attester while the server is the relying party.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">The flow starts with the client initiating a TLS exchange with the TLS
server operated by the cloud service provider. The client indicates
what evidence types it supports.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">The server obtains a nonce from the verifier, in real-time or from a
reserved nonce range, and returns it to the client alongside the
selected evidence type. Since the evidence will be returned in the
Certificate message the server has to request mutual authentication
via the CertificateRequest message.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">The client, when receiving the EncryptedExtension with the 
evidence_proposal, will proceed by invoking a local API to
request the attestation.  The returned evidence binds the identity key
with the workload and platform identity and security state.  The client
then signs the handshake transcript with the (attested) identity key,
and sends the evidence together with the signature over to
the server.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<p id="section-7.2-7">The server forwards the attestation evidence to the verifier, obtains 
the attestation result and checks that it is acceptable according to its 
local policy. The evidence verification combined with the verification of
the CertificateVerify signature provide confirmation that the presented
cryptographic identity is bound to the platform identity, and that the 
platform is trustworthy.<a href="#section-7.2-7" class="pilcrow">¶</a></p>
<p id="section-7.2-8">If successful, the server proceeds with the application layer protocol 
exchange. If, for some reason, the attestation result is not satisfactory
the TLS server will terminate the exchange.<a href="#section-7.2-8" class="pilcrow">¶</a></p>
<span id="name-example-exchange-with-clien"></span><div id="_figure-iot-example">
<figure id="figure-9">
          <div id="section-7.2-9.1">
            <div class="alignLeft art-svg artwork" id="section-7.2-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1136" width="576" viewBox="0 0 576 1136" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 8,112 L 8,1072" fill="none" stroke="black"></path>
                <path d="M 32,80 L 32,112" fill="none" stroke="black"></path>
                <path d="M 32,144 L 32,1072" fill="none" stroke="black"></path>
                <path d="M 136,40 L 136,72" fill="none" stroke="black"></path>
                <path d="M 136,128 L 136,144" fill="none" stroke="black"></path>
                <path d="M 168,80 L 168,1120" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 328,48 L 328,80" fill="none" stroke="black"></path>
                <path d="M 368,80 L 368,1120" fill="none" stroke="black"></path>
                <path d="M 400,48 L 400,80" fill="none" stroke="black"></path>
                <path d="M 440,368 L 440,376" fill="none" stroke="black"></path>
                <path d="M 480,48 L 480,80" fill="none" stroke="black"></path>
                <path d="M 528,80 L 528,1072" fill="none" stroke="black"></path>
                <path d="M 568,48 L 568,80" fill="none" stroke="black"></path>
                <path d="M 568,160 L 568,1056" fill="none" stroke="black"></path>
                <path d="M 8,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 328,48 L 400,48" fill="none" stroke="black"></path>
                <path d="M 480,48 L 568,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 328,80 L 400,80" fill="none" stroke="black"></path>
                <path d="M 480,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,112 L 120,112" fill="none" stroke="black"></path>
                <path d="M 8,144 L 552,144" fill="none" stroke="black"></path>
                <path d="M 168,256 L 360,256" fill="none" stroke="black"></path>
                <path d="M 368,304 L 520,304" fill="none" stroke="black"></path>
                <path d="M 376,416 L 528,416" fill="none" stroke="black"></path>
                <path d="M 176,544 L 368,544" fill="none" stroke="black"></path>
                <path d="M 40,576 L 168,576" fill="none" stroke="black"></path>
                <path d="M 32,608 L 160,608" fill="none" stroke="black"></path>
                <path d="M 40,640 L 168,640" fill="none" stroke="black"></path>
                <path d="M 32,672 L 160,672" fill="none" stroke="black"></path>
                <path d="M 168,720 L 360,720" fill="none" stroke="black"></path>
                <path d="M 368,832 L 520,832" fill="none" stroke="black"></path>
                <path d="M 376,896 L 528,896" fill="none" stroke="black"></path>
                <path d="M 368,912 L 392,912" fill="none" stroke="black"></path>
                <path d="M 376,944 L 392,944" fill="none" stroke="black"></path>
                <path d="M 368,960 L 392,960" fill="none" stroke="black"></path>
                <path d="M 376,992 L 392,992" fill="none" stroke="black"></path>
                <path d="M 8,1072 L 552,1072" fill="none" stroke="black"></path>
                <path d="M 176,1104 L 360,1104" fill="none" stroke="black"></path>
                <path d="M 120,112 C 128.83064,112 136,119.16936 136,128" fill="none" stroke="black"></path>
                <path d="M 552,144 C 560.83064,144 568,151.16936 568,160" fill="none" stroke="black"></path>
                <path d="M 392,912 C 400.83064,912 408,919.16936 408,928" fill="none" stroke="black"></path>
                <path d="M 392,944 C 400.83064,944 408,936.83064 408,928" fill="none" stroke="black"></path>
                <path d="M 392,960 C 400.83064,960 408,967.16936 408,976" fill="none" stroke="black"></path>
                <path d="M 392,992 C 400.83064,992 408,984.83064 408,976" fill="none" stroke="black"></path>
                <path d="M 552,1072 C 560.83064,1072 568,1064.83064 568,1056" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="528,832 516,826.4 516,837.6" fill="black" transform="rotate(0,520,832)"></polygon>
                <polygon class="arrowhead" points="528,304 516,298.4 516,309.6" fill="black" transform="rotate(0,520,304)"></polygon>
                <polygon class="arrowhead" points="384,992 372,986.4 372,997.6" fill="black" transform="rotate(180,376,992)"></polygon>
                <polygon class="arrowhead" points="384,944 372,938.4 372,949.6" fill="black" transform="rotate(180,376,944)"></polygon>
                <polygon class="arrowhead" points="384,896 372,890.4 372,901.6" fill="black" transform="rotate(180,376,896)"></polygon>
                <polygon class="arrowhead" points="384,416 372,410.4 372,421.6" fill="black" transform="rotate(180,376,416)"></polygon>
                <polygon class="arrowhead" points="368,1104 356,1098.4 356,1109.6" fill="black" transform="rotate(0,360,1104)"></polygon>
                <polygon class="arrowhead" points="368,720 356,714.4 356,725.6" fill="black" transform="rotate(0,360,720)"></polygon>
                <polygon class="arrowhead" points="368,256 356,250.4 356,261.6" fill="black" transform="rotate(0,360,256)"></polygon>
                <polygon class="arrowhead" points="184,1104 172,1098.4 172,1109.6" fill="black" transform="rotate(180,176,1104)"></polygon>
                <polygon class="arrowhead" points="184,544 172,538.4 172,549.6" fill="black" transform="rotate(180,176,544)"></polygon>
                <polygon class="arrowhead" points="168,672 156,666.4 156,677.6" fill="black" transform="rotate(0,160,672)"></polygon>
                <polygon class="arrowhead" points="168,608 156,602.4 156,613.6" fill="black" transform="rotate(0,160,608)"></polygon>
                <polygon class="arrowhead" points="48,640 36,634.4 36,645.6" fill="black" transform="rotate(180,40,640)"></polygon>
                <polygon class="arrowhead" points="48,576 36,570.4 36,581.6" fill="black" transform="rotate(180,40,576)"></polygon>
                <g class="text">
                  <text x="64" y="52">Attestation</text>
                  <text x="180" y="52">Client</text>
                  <text x="48" y="68">Service</text>
                  <text x="364" y="68">Server</text>
                  <text x="524" y="68">Verifier</text>
                  <text x="32" y="132">TLS</text>
                  <text x="88" y="132">handshake</text>
                  <text x="224" y="180">ClientHello</text>
                  <text x="208" y="196">{...}</text>
                  <text x="260" y="212">evidence_proposal(</text>
                  <text x="252" y="228">types(a,b,c)</text>
                  <text x="192" y="244">)</text>
                  <text x="224" y="292">ServerHello</text>
                  <text x="396" y="292">POST</text>
                  <text x="464" y="292">/newSession</text>
                  <text x="208" y="308">{...}</text>
                  <text x="392" y="324">201</text>
                  <text x="440" y="324">Created</text>
                  <text x="416" y="340">Location:</text>
                  <text x="484" y="340">/76839</text>
                  <text x="400" y="356">Body:</text>
                  <text x="432" y="356">{</text>
                  <text x="416" y="372">nonce</text>
                  <text x="256" y="388">EncryptedExtensions</text>
                  <text x="444" y="388">types(a,b,c)</text>
                  <text x="208" y="404">{...}</text>
                  <text x="384" y="404">}</text>
                  <text x="260" y="420">evidence_proposal(</text>
                  <text x="228" y="436">nonce,</text>
                  <text x="232" y="452">type(a)</text>
                  <text x="192" y="468">)</text>
                  <text x="252" y="484">CertificateRequest</text>
                  <text x="224" y="500">Certificate</text>
                  <text x="96" y="516">attest_key(</text>
                  <text x="248" y="516">CertificateVerify</text>
                  <text x="92" y="532">nonce,</text>
                  <text x="212" y="532">Finished</text>
                  <text x="80" y="548">TIK</text>
                  <text x="56" y="564">)</text>
                  <text x="84" y="596">CAB(KAT,</text>
                  <text x="140" y="596">PAT)</text>
                  <text x="100" y="628">sign(TIK,hs)</text>
                  <text x="96" y="660">sig</text>
                  <text x="260" y="676">Certificate(KAT,PAT)</text>
                  <text x="268" y="692">CertificateVerify(sig)</text>
                  <text x="212" y="708">Finished</text>
                  <text x="396" y="756">POST</text>
                  <text x="456" y="756">/76839A9E</text>
                  <text x="400" y="772">Body:</text>
                  <text x="432" y="772">{</text>
                  <text x="428" y="788">type(a),</text>
                  <text x="408" y="804">CAB</text>
                  <text x="384" y="820">}</text>
                  <text x="400" y="852">Body:</text>
                  <text x="432" y="852">{</text>
                  <text x="432" y="868">att-result:</text>
                  <text x="500" y="868">AR{}</text>
                  <text x="384" y="884">}</text>
                  <text x="444" y="932">verify</text>
                  <text x="492" y="932">AR{}</text>
                  <text x="444" y="980">verify</text>
                  <text x="488" y="980">sig</text>
                  <text x="248" y="1092">application</text>
                  <text x="316" y="1092">data</text>
                </g>
              </svg><a href="#section-7.2-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-example-exchange-with-clien" class="selfRef">Example Exchange with Client as Attester.</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-cons">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">TBD.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="tls-extensions">
<section id="section-9.1">
        <h3 id="name-tls-extensions">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-tls-extensions" class="section-name selfRef">TLS Extensions</a>
        </h3>
<p id="section-9.1-1">IANA is asked to allocate two new TLS extensions, evidence_request
and evidence_proposal, from the "TLS ExtensionType Values"
subregistry of the "Transport Layer Security (TLS) Extensions"
registry <span>[<a href="#TLS-Ext-Registry" class="cite xref">TLS-Ext-Registry</a>]</span>.  These extensions are used in
the ClientHello and the EncryptedExtensions messages. The
values carried in these extensions are taken from TBD.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls-alerts">
<section id="section-9.2">
        <h3 id="name-tls-alerts">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-tls-alerts" class="section-name selfRef">TLS Alerts</a>
        </h3>
<p id="section-9.2-1">IANA is requested to allocate a value in the "TLS Alerts"
subregistry of the "Transport Layer Security (TLS) Parameters" registry
<span>[<a href="#TLS-Param-Registry" class="cite xref">TLS-Param-Registry</a>]</span> and populate it with the following entry:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-2.1">Value: TBD1<a href="#section-9.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-2.2">Description: unsupported_evidence<a href="#section-9.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-2.3">DTLS-OK: Y<a href="#section-9.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-2.4">Reference: [This document]<a href="#section-9.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-2.5">Comment:<a href="#section-9.2-2.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="tls-certificate-types">
<section id="section-9.3">
        <h3 id="name-tls-certificate-types">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-tls-certificate-types" class="section-name selfRef">TLS Certificate Types</a>
        </h3>
<p id="section-9.3-1">IANA is requested to allocate a new value in the "TLS Certificate Types"
subregistry of the "Transport Layer Security (TLS) Extensions"
registry <span>[<a href="#TLS-Ext-Registry" class="cite xref">TLS-Ext-Registry</a>]</span>, as follows:<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-2.1">Value: TBD2<a href="#section-9.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.3-2.2">Description: Attestation<a href="#section-9.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.3-2.3">Reference: [This document]<a href="#section-9.3-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.bft-rats-kat">[I-D.bft-rats-kat]</dt>
        <dd>
<span class="refAuthor">Brossard, M.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"An EAT-based Key Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bft-rats-kat-00</span>, <time datetime="2022-10-21" class="refDate">21 October 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-00">https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ftbs-rats-msg-wrap">[I-D.ftbs-rats-msg-wrap]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Smith, N.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"RATS Conceptual Messages Wrapper"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ftbs-rats-msg-wrap-02</span>, <time datetime="2023-03-07" class="refDate">7 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ftbs-rats-msg-wrap-02">https://datatracker.ietf.org/doc/html/draft-ftbs-rats-msg-wrap-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DICE-Layering">[DICE-Layering]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"DICE Layering Architecture Version 1.00 Revision 0.19"</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/dice-layering-architecture/">https://trustedcomputinggroup.org/resource/dice-layering-architecture/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.acme-device-attest">[I-D.acme-device-attest]</dt>
        <dd>
<span class="refAuthor">Weeks, B.</span>, <span class="refTitle">"Automated Certificate Management Environment (ACME) Device Attestation Extension"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-acme-device-attest-00</span>, <time datetime="2022-12-12" class="refDate">12 December 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-acme-device-attest-00">https://datatracker.ietf.org/doc/html/draft-acme-device-attest-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-ar4si">[I-D.ietf-rats-ar4si]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Hardjono, T.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">V. Scarlata</span>, <span class="refTitle">"Attestation Results for Secure Interactions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-ar4si-04</span>, <time datetime="2023-03-02" class="refDate">2 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-04">https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-architecture">[I-D.ietf-rats-architecture]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-architecture-22</span>, <time datetime="2022-09-28" class="refDate">28 September 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-architecture-22">https://datatracker.ietf.org/doc/html/draft-ietf-rats-architecture-22</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-eat">[I-D.ietf-rats-eat]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-19</span>, <time datetime="2022-12-19" class="refDate">19 December 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-19">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RA-TLS">[RA-TLS]</dt>
        <dd>
<span class="refAuthor">Knauth, T.</span>, <span class="refAuthor">Steiner, M.</span>, <span class="refAuthor">Chakrabarti, S.</span>, <span class="refAuthor">Lei, L.</span>, <span class="refAuthor">Xing, C.</span>, and <span class="refAuthor">M. Vij</span>, <span class="refTitle">"Integrating Remote Attestation with Transport Layer Security"</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://arxiv.org/abs/1801.05863">https://arxiv.org/abs/1801.05863</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS-Ext-Registry">[TLS-Ext-Registry]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions"</span>, <span>&lt;<a href="https://www.iana.org/assignments/tls-extensiontype-values">https://www.iana.org/assignments/tls-extensiontype-values</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS-Param-Registry">[TLS-Param-Registry]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Transport Layer Security (TLS) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/tls-parameters">https://www.iana.org/assignments/tls-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM1.2">[TPM1.2]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM Main Specification Level 2 Version 1.2, Revision 116"</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-main-specification/">https://trustedcomputinggroup.org/resource/tpm-main-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.0">[TPM2.0]</dt>
      <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library Specification, Family "2.0", Level 00, Revision 01.59"</span>, <time datetime="2019-11" class="refDate">November 2019</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">https://trustedcomputinggroup.org/resource/tpm-library-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="usage-variants">
<section id="appendix-A">
      <h2 id="name-design-rationale-x509-and-a">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-design-rationale-x509-and-a" class="section-name selfRef">Design Rationale: X.509 and Attestation Usage Variants</a>
      </h2>
<p id="appendix-A-1">The inclusion of attestation results and evidence as part of the TLS
handshake offers the relying party information about the state of the
system and its cryptographic keys, but lacks the means to specify a stable
endpoint identifier. While it is possible to solve this problem by
including an identifier as part of the attestation result, some use cases
require the use of a public key infrastructure (PKI). It is therefore
important to consider the possible approaches for conveying X.509
certificates and attestation within a single handshake.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">In general, the following combinations of X.509 and attestation usage are
possible:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A-3">
<li id="appendix-A-3.1">X.509 certificates only: In this case no attestation is exchanged in the
 TLS handshake. Authentication relies on PKI alone, i.e. TLS with X.509
 certificates.<a href="#appendix-A-3.1" class="pilcrow">¶</a>
</li>
        <li id="appendix-A-3.2">
          <p id="appendix-A-3.2.1">X.509 certificates containing attestation extension: The X.509
 certificates in the Certificate message carry attestation as part of
 the X.509 certificate extensions. Several proposals exist that enable
 this functionality:<a href="#appendix-A-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-3.2.2.1">
              <p id="appendix-A-3.2.2.1.1">Custom X.509 extension:<a href="#appendix-A-3.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-3.2.2.1.2.1">Attester-issued certificates (e.g., RA-TLS <span>[<a href="#RA-TLS" class="cite xref">RA-TLS</a>]</span>): The
attester acts as a certification authority (CA) and includes the
attestation evidence within an X.509 extension.<a href="#appendix-A-3.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-A-3.2.2.1.2.2">DICE defines extensions that include attestation information in
the "Embedded CA" certificates (See Section 8.1.1.1 of <span>[<a href="#DICE-Layering" class="cite xref">DICE-Layering</a>]</span>).<a href="#appendix-A-3.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-A-3.2.2.1.2.3">Third party CA-issued certificates (e.g., ACME Device Attestation
<span>[<a href="#I-D.acme-device-attest" class="cite xref">I-D.acme-device-attest</a>]</span>): Remote attestation is performed between
the third party CA and the attester prior to certificate issuance,
after which the CA adds an extension indicating that the certificate
key has fulfilled some verification policy.<a href="#appendix-A-3.2.2.1.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-A-3.2.2.2">Explicit signalling via existing methods, e.g. using a policy OID in
the end-entity certificate.<a href="#appendix-A-3.2.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A-3.2.2.3">Implicit signalling, e.g. via the issuer name.<a href="#appendix-A-3.2.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="appendix-A-3.3">X.509 certificates alongside a PAT: This use case assumes that a keypair
 with a corresponding certificate already exists and that the owner
 wishes to continue using it. As a consequence, there is no
 cryptographic linkage between the certificate and the PAT. This
 approach is described in <a href="#pkix-attest" class="auto internal xref">Section 5.2</a>.<a href="#appendix-A-3.3" class="pilcrow">¶</a>
</li>
        <li id="appendix-A-3.4">X.509 certificates alongside the PAT and KAT: The addition of key
 attestation implies that the TLS identity key must have been generated
 and stored securely by the attested platform. Unlike in variant (3),
 the certificate, the KAT, and the PAT must be cryptographically linked.
 This variant is currently not addressed in this document.<a href="#appendix-A-3.4" class="pilcrow">¶</a>
</li>
        <li id="appendix-A-3.5">Combined PAT/KAT: With this variant the attestation token carries
 information pertaining to both platform and key. No X.509 certificate
 is transmitted during the handshake. This approach is currently not
 addressed in this document.<a href="#appendix-A-3.5" class="pilcrow">¶</a>
</li>
        <li id="appendix-A-3.6">PAT alongside KAT: This variant is similar to (5) with the exception
 that the key and the platform attestations are stored in separate
 tokens, cryptographically linked together. This approach is covered by
 this document in <a href="#attest-only" class="auto internal xref">Section 5.1</a>. A possible instantiation of the KAT
 is described in <span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>.<a href="#appendix-A-3.6" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="binding-mech">
<section id="appendix-B">
      <h2 id="name-cross-protocol-binding-mech">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-cross-protocol-binding-mech" class="section-name selfRef">Cross-protocol binding mechanism</a>
      </h2>
<p id="appendix-B-1">Note: This section describes a protocol-agnostic mechanism which is used in
the context of TLS within the body of the draft. The mechanism might, in
the future, be spun out into its own document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">One of the issues that must be addressed when using remote attestation as
an authentication mechanism is the binding to the outer protocol (i.e., the
protocol requiring authentication). For every instance of the combined
protocol, the remote attestation credentials must be verifiably linked to
the outer protocol. The main reason for this requirement is security: a
lack of binding can result in the attestation credentials being relayed.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">If the attestation credentials can be enhanced freely and in a verifiable
way, the binding can be performed by inserting the relevant data as new
claims. If the ways of enhancing the credentials are more restricted,
ad-hoc solutions can be devised which address the issue. For example, many
roots of trust only allow a small amount (32-64 bytes) of user-provided
data which will be included in the attestation token. If more data must be
included, it must therefore be compressed. In this case, the problem is
compounded by the need to also include a challenge value coming from the
relying party. The verification steps also become more complex, as the
binding data must be returned from the verifier and checked by the relying
party.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">However, regardless of how the binding and verification are performed,
similar but distinct approaches need to be taken for every protocol into
which remote attestation is embedded, as the type or semantics of the
binding data could differ. A more standardised way of tackling this issue
would therefore be beneficial. This appendix presents a solution to this
problem, in the context of attestation evidence.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<div id="binding-mechanism">
<section id="appendix-B.1">
        <h3 id="name-binding-mechanism">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-binding-mechanism" class="section-name selfRef">Binding mechanism</a>
        </h3>
<p id="appendix-B.1-1">The core of the binding mechanism consists of a new token format - the
Attestation Channel Binder - that represents a set of binders as a CBOR
map. Binders are individual pieces of data with an unambiguous definition.
Each binder is a name/value pair, where the name must be an integer and the
value must be a byte string.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">Each protocol using the Attestation Channel Binder to bind attestation
credentials must define its Attestation Channel Binder using CDDL. The only
mandated binder is the challenger nonce which must use the value 1 as a
name. Every other name/value pair must come with a text description of its
semantics. The byte strings forming the values of binders can be
size-restricted where this value is known.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-3">Attestation Channel Binders are encoded in CBOR, following the CBOR core
deterministic encoding requirements (<span><a href="https://rfc-editor.org/rfc/rfc8949#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>).<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<p id="appendix-B.1-4">An example Attestation Channel Binder is shown below.<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<span id="name-format-of-a-possible-tls-at"></span><div id="_figure-binder-format">
<figure id="figure-10">
          <div class="alignLeft art-text artwork" id="appendix-B.1-5.1">
<pre>
attestation_channel_binder = {
  &amp;(nonce: 1) =&gt; bstr .size (8..64)
  &amp;(ik_pub_fingerprint: 2) =&gt; bstr .size 32
  &amp;(session_key_binder: 3) =&gt; bstr .size 32
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-format-of-a-possible-tls-at" class="selfRef">Format of a possible TLS Attestation Channel Binder.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="usage">
<section id="appendix-B.2">
        <h3 id="name-usage">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-usage" class="section-name selfRef">Usage</a>
        </h3>
<p id="appendix-B.2-1">When a Attestation Channel Binder is used to compress data to fit the space
afforded by an attestation scheme, the encoded binder must be hashed. Since
the relying party has access to all the data expected in the binder, the
binder itself need not be conveyed. How the hashing algorithm is chosen,
used, and conveyed must be defined per outer protocol. If the digest size
does not match the user data size mandated by the attestation scheme, the
digest is truncated or expanded appropriately.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The verifier must first hash the encoded token received from the relying
party and then compare the hashes. The challenge value included in the
binder can then be extracted and verified. If verification is successful,
binder correctness can also be assumed by the relying party, as
verification was done with the values it expected.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="history">
<section id="appendix-C">
      <h2 id="name-history">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-history" class="section-name selfRef">History</a>
      </h2>
<p id="appendix-C-1">RFC EDITOR: PLEASE REMOVE THIS SECTION<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="draft-fossati-tls-attestation-02">
<section id="appendix-C.1">
        <h3 id="name-draft-fossati-tls-attestati">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-draft-fossati-tls-attestati" class="section-name selfRef">draft-fossati-tls-attestation-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">Focus on the background check model<a href="#appendix-C.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.2">Added examples<a href="#appendix-C.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.3">Updated introduction<a href="#appendix-C.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-C.1-1.4">Moved attestation format-specific content to related drafts.<a href="#appendix-C.1-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-fossati-tls-attestation-01">
<section id="appendix-C.2">
        <h3 id="name-draft-fossati-tls-attestatio">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-draft-fossati-tls-attestatio" class="section-name selfRef">draft-fossati-tls-attestation-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">Added details about TPM attestation<a href="#appendix-C.2-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-fossati-tls-attestation-00">
<section id="appendix-C.3">
        <h3 id="name-draft-fossati-tls-attestation">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-draft-fossati-tls-attestation" class="section-name selfRef">draft-fossati-tls-attestation-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">Initial version<a href="#appendix-C.3-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="working-group-information">
<section id="appendix-D">
      <h2 id="name-working-group-information">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-working-group-information" class="section-name selfRef">Working Group Information</a>
      </h2>
<p id="appendix-D-1">The discussion list for the IETF TLS working group is located at the e-mail
address <a href="mailto:tls@ietf.org">tls@ietf.org</a>. Information on the group and information on how to
subscribe to the list is at <a href="https://www1.ietf.org/mailman/listinfo/tls">https://www1.ietf.org/mailman/listinfo/tls</a><a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">Archives of the list can be found at:
<a href="https://www.ietf.org/mail-archive/web/tls/current/index.html">https://www.ietf.org/mail-archive/web/tls/current/index.html</a><a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaron Sheffer</span></div>
<div dir="auto" class="left"><span class="org">Intuit</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yaronf.ietf@gmail.com" class="email">yaronf.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paul Howard</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Paul.Howard@arm.com" class="email">Paul.Howard@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ionut Mihalcea</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Ionut.Mihalcea@arm.com" class="email">Ionut.Mihalcea@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yogesh Deshpande</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Yogesh.Deshpande@arm.com" class="email">Yogesh.Deshpande@arm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
